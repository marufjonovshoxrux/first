<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>IELTS Full Reading Practice</title>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: Arial, sans-serif;
				background-color: #ffffff;
				line-height: 1.4;
				font-size: 16px;
			}

			.header {
				background-color: #ffffff;
				padding: 12px 20px;
				border-bottom: 1px solid #e0e0e0;
				display: flex;
				justify-content: space-between;
				align-items: center;
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				z-index: 100;
				height: 60px;
			}

			.ielts-logo {
				display: none;
			}

			.test-info {
				display: flex;
				align-items: center;
				gap: 30px;
				font-size: 14px;
				color: #333;
			}

			.audio-indicator {
				display: flex;
				align-items: center;
				gap: 8px;
				font-size: 16px;
			}

			.audio-icon {
				width: 16px;
				height: 16px;
				background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon></svg>')
					no-repeat center;
			}

			.header-icons {
				display: flex;
				gap: 10px;
				align-items: center;
			}

			.telegram-link {
				color: #0088cc;
				text-decoration: none;
				font-weight: 600;
				font-size: 16px;
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.telegram-link:hover {
				text-decoration: underline;
			}

			.telegram-link::before {
				content: '';
				display: inline-block;
				width: 20px;
				height: 20px;
				background-color: currentColor;
				-webkit-mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
				mask-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.78 18.65l.28-4.23l7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3L3.64 12c-.88-.25-.89-1.37.2-1.64l16.56-6.4c.75-.29 1.4.22 1.2.94l-2.67 12.61c-.22.95-1.13 1.18-1.78.73l-4.5-3.32l-2.23 2.15c-.47.44-1.29.21-1.48-.37z"/></svg>');
				background-size: contain;
				background-repeat: no-repeat;
			}

			#volume-slider {
				-webkit-appearance: none;
				width: 80px;
				height: 4px;
				background: #ddd;
				outline: none;
				border-radius: 2px;
				cursor: pointer;
			}

			#volume-slider::-webkit-slider-thumb {
				-webkit-appearance: none;
				appearance: none;
				width: 14px;
				height: 14px;
				border-radius: 50%;
				background: #333;
				cursor: pointer;
			}

			#volume-slider::-moz-range-thumb {
				width: 14px;
				height: 14px;
				border-radius: 50%;
				background: #333;
				cursor: pointer;
				border: none;
			}

			.icon {
				width: 20px;
				height: 20px;
				cursor: pointer;
				opacity: 0.7;
				color: #333;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.icon:hover {
				opacity: 1;
			}

			#play-pause-btn {
				background: none;
				border: none;
				padding: 0;
			}

			.main-container {
				margin-top: 60px;
				display: flex;
				flex-direction: column;
				background: #ffffff;
				height: calc(100vh - 60px); /* Full height minus header */
			}

			.panels-container {
				display: flex;
				flex: 1;
				overflow: hidden;
			}

			.passage-panel {
				flex: 1;
				padding: 20px 20px 100px;
				overflow-y: auto;
				min-width: 200px; /* Minimum width */
			}

			/* Passage Content */
			.text-center {
				text-align: center;
			}
			.reading-passage h4 {
				font-size: 20px;
				font-weight: bold;
				margin-bottom: 15px;
				text-align: center;
			}

			.reading-passage p {
				margin-bottom: 1.2em;
			}

			.question ul li label {
				display: block;
				margin-top: 8px;
				cursor: pointer;
			}

			.questions-panel {
				flex: 1;
				padding: 20px 20px 100px;
				overflow-y: auto;
				min-width: 200px; /* Minimum width */
				border-left: 1px solid #e0e0e0;
			}

			.resizer {
				width: 10px;
				cursor: col-resize;
				background-color: #f0f0f0;
				background-image: url('data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" width="10" height="30" viewBox="0 0 10 30"><path d="M4 11h2v2H4zM4 15h2v2H4zM4 19h2v2H4z" fill="%23888"/></svg>');
				background-repeat: no-repeat;
				background-position: center;
				flex-shrink: 0;
				flex-grow: 0;
			}

			/* Left Panel */
			.left-panel {
				width: 100%;
				padding: 20px;
			}

			/* Right Panel */
			.right-panel {
				display: none;
				width: 50%;
				padding: 20px;
				position: relative;
			}

			.help-button {
				background: #4a90e2;
				color: white;
				border: none;
				padding: 6px 12px;
				border-radius: 4px;
				font-size: 14px;
				cursor: pointer;
				display: inline-flex;
				align-items: center;
				gap: 5px;
				margin-bottom: 20px;
			}

			.help-button:hover {
				background: #357abd;
			}

			.section-title {
				font-weight: bold;
				margin-bottom: 15px;
				font-size: 18px;
			}

			.people-section {
				margin-bottom: 30px;
			}

			.people-table {
				width: 100%;
				border-collapse: collapse;
				border: 1px solid #ccc;
			}

			.people-table th {
				text-align: left;
				padding: 10px;
				font-weight: bold;
				border: 1px solid #ddd;
			}

			.people-table td {
				padding: 8px 10px;
				border: 1px solid #ddd;
			}

			.person-name {
				font-size: 16px;
			}

			.question-number {
				background: white;
				border: 1px solid #4a90e2;
				padding: 4px 8px;
				border-radius: 3px;
				font-weight: bold;
				font-size: 14px;
				color: #4a90e2;
				min-width: 30px;
				text-align: center;
			}

			.assigned-responsibility {
				background: #f0f0f0;
				padding: 4px 8px;
				border-radius: 3px;
				font-size: 14px;
				border: 1px solid #ddd;
			}

			.responsibilities-section {
				margin-bottom: 30px;
			}

			.responsibility-grid {
				display: grid;
				grid-template-columns: repeat(3, 1fr);
				gap: 8px;
				margin-bottom: 20px;
			}

			.responsibility-item {
				background: #f8f9fa;
				border: 1px solid #ddd;
				padding: 8px 12px;
				border-radius: 4px;
				cursor: move;
				font-size: 16px;
				text-align: center;
				transition: all 0.2s;
			}

			.responsibility-item:hover {
				background: #e9ecef;
				transform: translateY(-1px);
			}

			.responsibility-item.dragging {
				opacity: 0.5;
			}

			.questions-section {
				margin-bottom: 20px;
			}

			.question-title {
				font-weight: bold;
				margin-bottom: 10px;
				font-size: 16px;
			}

			.instruction {
				margin-bottom: 20px;
				font-size: 16px;
				color: #666;
			}

			/* Map Styles */
			.map-container {
				position: relative;
				margin: 20px 0;
				display: flex;
				justify-content: center;
			}

			.map-svg {
				border: 2px solid #333;
				background: white;
			}

			.map-room {
				fill: #f9f9f9;
				stroke: #333;
				stroke-width: 1;
			}

			.map-text {
				font-family: Arial, sans-serif;
				font-size: 13px;
				text-anchor: middle;
				fill: #333;
			}

			.map-number {
				font-family: Arial, sans-serif;
				font-size: 16px;
				font-weight: bold;
				text-anchor: middle;
				fill: #333;
			}

			.room-labels {
				display: grid;
				grid-template-columns: repeat(3, 1fr);
				gap: 10px;
				margin: 20px 0;
			}

			.room-label {
				background: #f8f9fa;
				border: 1px solid #ddd;
				padding: 8px 12px;
				border-radius: 4px;
				cursor: move;
				font-size: 16px;
				text-align: center;
				transition: all 0.2s;
			}

			.room-label:hover {
				background: #e9ecef;
				transform: translateY(-1px);
			}

			.room-label.dragging {
				opacity: 0.5;
			}

			/* Navigation Arrows */
			.nav-arrows {
				position: fixed;
				bottom: 100px;
				right: 20px;
				display: flex;
				gap: 5px;
				z-index: 101;
			}

			.nav-arrow {
				width: 50px;
				height: 50px;
				background: #333;
				color: white;
				border: none;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 22px;
				font-weight: bold;
			}

			.nav-arrow:hover {
				background: #555;
			}

			.nav-arrow:disabled {
				background: #ccc;
				cursor: not-allowed;
			}

			/* Bottom Navigation - Exact Match */
			.nav-row {
				position: fixed;
				bottom: 0;
				left: 0;
				right: 0;
				background: #ffffff;

				padding: 0;
				display: flex;
				align-items: center;
				height: 80px;
				z-index: 100;
			}

			.footer__questionWrapper___1tZ46 {
				display: flex;
				align-items: center;
				margin-right: 20px;
			}

			.footer__questionNo___3WNct {
				background: none;
				border: none;
				padding: 10px 15px;
				font-size: 16px;
				font-weight: 600;
				color: #333;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 5px;
				transition: background-color 0.2s;
			}

			.footer__questionNo___3WNct:hover {
				background-color: #f8f9fa;
			}

			.section-prefix {
				font-size: 16px;
			}

			.sectionNr {
				font-size: 16px;
				font-weight: bold;
			}

			.attemptedCount {
				font-size: 14px;
				color: #666;
				margin-left: 5px;
				font-weight: 400; /* Normal weight */
			}

			@media (max-width: 768px) {
				.attemptedCount {
					display: none;
				}
			}

			.footer__questionWrapper___1tZ46.selected .attemptedCount {
				display: none;
			}

			.footer__subquestionWrapper___9GgoP {
				display: none;
				gap: 2px;
				margin-left: 10px;
			}

			.footer__questionWrapper___1tZ46.selected
				.footer__subquestionWrapper___9GgoP {
				display: flex;
			}

			.subQuestion {
				width: 32px;
				height: 32px;
				border: 1px solid #ccc;
				background: white;
				color: #333;
				font-size: 14px;
				font-weight: 500;
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.2s;
				border-radius: 2px;
			}

			.subQuestion.answered {
				background-color: #e9ecef;
				border-color: #ddd;
			}
			.subQuestion.correct {
				background-color: #28a745;
				color: white;
				border-color: #28a745;
			}
			.subQuestion.incorrect {
				background-color: #dc3545;
				color: white;
				border-color: #dc3545;
			}

			.subQuestion:hover {
				background-color: #f0f0f0;
				border-color: #999;
			}

			.subQuestion.active {
				background-color: #4a90e2;
				color: white;
				border-color: #4a90e2;
			}

			.subQuestion.completed {
				background-color: #28a745;
				color: white;
				border-color: #28a745;
			}

			.sr-only {
				position: absolute;
				width: 1px;
				height: 1px;
				padding: 0;
				margin: -1px;
				overflow: hidden;
				clip: rect(0, 0, 0, 0);
				white-space: nowrap;
				border: 0;
			}

			.footer__deliverButton___3FM07 {
				margin-left: auto;
				margin-right: 20px;
				background-color: #f0f0f0;
				color: #333;
				border: 1px solid #ccc;
				padding: 12px 20px;
				border-radius: 4px;
				font-size: 16px;
				font-weight: 600;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				transition: background-color 0.2s, border-color 0.2s;
				min-width: 170px;
				justify-content: center;
			}

			.footer__deliverButton___3FM07:hover {
				background-color: #e0e0e0;
				border-color: #bbb;
			}

			.footer__deliverButton___3FM07:disabled {
				background: #e9ecef;
				color: #6c757d;
				cursor: not-allowed;
				border-color: #ddd;
			}

			.fa-check::before {
				content: '✓';
			}

			.hidden {
				display: none !important;
			}

			/* Context Menu */
			.context-menu {
				position: absolute;
				background: white;
				border: 1px solid #ccc;
				border-radius: 6px;
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
				z-index: 1000;
				display: none;
				min-width: 140px;
			}

			.context-menu-item {
				padding: 12px 16px;
				cursor: pointer;
				font-size: 16px;
				border-bottom: 1px solid #f0f0f0;
				transition: background-color 0.2s;
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.context-menu-item:hover {
				background-color: #f8f9fa;
			}

			.context-menu-item:last-child {
				border-bottom: none;
			}

			.highlight {
				background-color: #ffff00;
			}

			.comment-highlight {
				background-color: #90ee90;
				position: relative;
				cursor: help;
			}

			.comment-tooltip {
				position: absolute;
				bottom: 100%;
				left: 50%;
				transform: translateX(-50%);
				background: #333;
				color: white;
				padding: 8px 12px;
				border-radius: 4px;
				font-size: 14px;
				white-space: nowrap;
				z-index: 1000;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.3s;
			}

			.comment-highlight:hover .comment-tooltip {
				opacity: 1;
			}

			.question {
				margin-bottom: 40px;
			}
			.question p {
				margin-bottom: 10px;
			}
			.question ul,
			.question .people-table {
				margin-top: 0;
			}
			.question-prompt {
				margin-bottom: 20px;
			}
			.question ul {
				list-style: none;
				padding-left: 0;
			}
			.question ul li {
				margin-bottom: 5px;
			}
			.answer-input {
				border: 1px solid #888;
				border-radius: 4px;
				background-color: #fff;
				padding: 2px 5px;
				font-size: 16px;
				text-align: center;
				margin-right: 4px;
				margin-left: 4px;
				transition: border-color 0.3s, box-shadow 0.3s;
				height: 28px; /* Standard height */
				width: 150px; /* Standard width */
			}
			.answer-input.active-input {
				border-color: #4a90e2;
				box-shadow: 0 0 3px 1px rgba(74, 144, 226, 0.5);
			}
			.answer-input::placeholder {
				color: #999;
				font-weight: bold;
				text-align: center;
			}
			.answer-input.correct {
				border-color: #28a745;
				background-color: #e9f7ef;
			}
			.answer-input.incorrect {
				border-color: #dc3545;
				background-color: #f8d7da;
				color: #721c24;
			}
			.answer-input {
				z-index: 10;
				position: relative;
				pointer-events: auto;
			}
			.summary-text .answer-input {
				width: 120px;
				height: 24px;
				font-size: 14px;
				margin: 0 4px;
			}
			.answer-inputs {
				display: flex;
				flex-direction: column;
				gap: 10px;
				margin-top: 15px;
			}
			.answer-inputs .answer-input {
				width: 200px;
				height: 30px;
				font-size: 16px;
			}
			.drag-drop-container {
				display: flex;
				gap: 30px;
				margin-top: 20px;
				align-items: flex-start;
			}
			.recommendations-box {
				display: flex;
				flex-direction: column;
				gap: 8px;
				min-height: 200px;
			}
			.drag-item {
				background: white;
				border: 1px solid #9c9c9c;
				font-weight: 600;
				padding: 0px 5px;
				border-radius: 4px;
				cursor: move;
				font-size: 16px;
				transition: all 0.2s;
				user-select: none;
			}
			.drag-item:hover {
				background: #e9ecef;
			}
			.drag-item.dragging {
				opacity: 0.5;
			}
			.drag-item.selected {
				border-color: #4a90e2;
				box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.5);
			}
			.drop-zone {
				border: 2px dashed #aaa;
				border-radius: 4px;
				width: 50%;
				margin-top: 19px;
				margin-bottom: 5px;
				transition: background-color 0.2s, border-color 0.2s;
				padding: 0.5px;
				display: flex;
				align-items: center;
				justify-content: center;
				position: relative;
			}
			.drop-zone.drag-over {
				background-color: #e6f4ff;
				border-color: #4a90e2;
			}
			.drop-zone.correct {
				background-color: #e9f7ef;
				border-color: #28a745;
				border-style: solid;
			}
			.drop-zone.incorrect {
				background-color: #f8d7da;
				border-color: #dc3545;
				border-style: solid;
			}
			.drop-zone.disabled {
				pointer-events: none;
			}
			.drop-zone .drag-item {
				width: 100%;
				height: 100%;
				display: flex;
				align-items: center;
				justify-content: center;
				font-size: 15px;
				padding: 2px;
			}
			.drag-options-container {
				margin-top: 10px;
			}
			.drag-options-container .drag-item {
				display: block;
				width: fit-content;
				font-size: 15px;
				padding: 0.5px 10px;
				margin-bottom: 5px;
			}
			.drag-options-container .drag-item:last-child {
				margin-bottom: 0;
			}
			.q-number {
				color: #888;
				font-size: 14px;
				font-weight: bold;
			}
			.questions-container {
				width: 100%;
			}
			audio {
				width: 100%;
				margin-bottom: 20px;
			}
			.part-header {
				background-color: #f1f2ec;
				padding: 15px 20px;
				border: 1px solid #e0e0e0;
				text-align: left;
				margin: 10px 20px;
				border-radius: 5px;
			}
			.part-header p {
				margin: 0;
			}
			.part-header p:first-child {
				margin-bottom: 5px;
			}

			.question li.correct {
				color: #155724;
				font-weight: bold;
			}
			.question li.incorrect {
				color: #721c24;
			}
			.question li.correct::before {
				content: '✔ ';
				color: #28a745;
			}
			.question li.incorrect::before {
				content: '✖ ';
				color: #dc3545;
			}

			.example-box {
				border: 1px solid #ddd;
				background-color: #f9f9f9;
				padding: 15px;
				border-radius: 5px;
				margin: 20px 0;
			}

			.timer-container {
				display: flex;
				position: relative;
				cursor: default;
				color: #333;
				font-size: 16px;
				font-weight: 500;
				align-items: center;
			}
			.timer-container .timer-tooltip {
				display: none;
			}

			.timer-controls {
				display: flex;
				align-items: center;
				gap: 8px;
				margin-left: 15px;
			}

			.timer-controls button {
				background: #f0f0f0;
				border: 1px solid #ccc;
				border-radius: 50%;
				padding: 0;
				cursor: pointer;
				width: 32px;
				height: 32px;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: background-color 0.2s;
			}
			.timer-controls button:hover {
				background: #e0e0e0;
			}

			.timer-controls button svg {
				width: 20px;
				height: 20px;
				fill: #333;
			}

			.audio-modal-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(40, 40, 40, 0.9);
				z-index: 2000;
				display: flex;
				justify-content: center;
				align-items: center;
				color: white;
				text-align: center;
			}
			.audio-modal-content {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 20px;
				max-width: 500px;
				padding: 20px;
			}
			.audio-modal-content p {
				font-size: 16px;
				line-height: 1.5;
				color: #eee;
			}
			.audio-modal-icon {
				margin-bottom: 20px;
			}
			.modal-play-btn {
				background-color: #000;
				color: white;
				border: 1px solid white;
				padding: 12px 24px;
				border-radius: 6px;
				font-size: 18px;
				font-weight: 600;
				cursor: pointer;
				display: flex;
				align-items: center;
				gap: 8px;
				transition: background-color 0.2s;
			}
			.modal-play-btn:hover {
				background-color: #333;
			}
			#goto-widget {
				display: flex;
				align-items: center;
				gap: 5px;
			}
			#goto-input {
				width: 80px;
				padding: 4px 8px;
				border: 1px solid #ccc;
				border-radius: 4px;
			}
			#goto-btn {
				padding: 4px 10px;
				border: 1px solid #ccc;
				background-color: #f0f0f0;
				border-radius: 4px;
				cursor: pointer;
			}

			/* Styles for TRUE/FALSE/NOT GIVEN questions */
			.tf-question {
				margin-bottom: 25px;
				padding: 10px 0px;
				border-radius: 4px;
				transition: border-color 0.3s, background-color 0.3s;
			}
			.tf-question-line {
				display: flex;
				align-items: flex-start;
				margin-bottom: 15px;
				padding: 5px 0px;
				border-radius: 4px;
			}
			.tf-question-number,
			.question-number-box {
				border: 2px solid #ccc;
				padding: 2px 8px;
				margin-right: 10px;
				border-radius: 3px;
				font-weight: bold;
				transition: border-color 0.3s;
				display: inline-block;
			}
			.tf-question-text {
				padding-top: 3px;
			}
			.tf-options {
				padding-left: 5px;
			}
			.tf-option {
				display: block;
				margin-bottom: 12px;
				cursor: pointer;
				display: flex;
				align-items: center;
			}
			.tf-option input[type='radio'] {
				margin-right: 10px;
				transform: scale(1.2);
			}
			.tf-question.correct .tf-question-line {
				background-color: #e9f7ef;
			}
			.tf-question.incorrect .tf-question-line {
				background-color: #f8d7da;
			}
			.matching-question-container {
				display: flex;
				gap: 20px;
				margin-top: 15px;
			}
			.matching-options-bank {
				flex: 1;
				display: flex;
				flex-direction: column;
				gap: 8px;
			}
			.matching-questions {
				flex: 1.5;
				display: flex;
				flex-direction: column;
				gap: 15px;
			}
			.matching-question-item {
				display: flex;
				align-items: center;
				gap: 15px;

				border: 2px solid transparent;
				border-radius: 4px;
				transition: border-color 0.3s;
			}
			.matching-question-item > span {
				flex: 1;
			}
			.matching-question-item.correct {
				background-color: #e9f7ef;
				border-color: #28a745 !important;
			}
			.matching-question-item.incorrect {
				background-color: #f8d7da;
				border-color: #dc3545 !important;
			}
			.matching-question-item .drop-zone {
				width: 200px;
				flex-shrink: 0;
				margin: 0;
				display: flex;
				align-items: center;
				justify-content: center;
				font-weight: bold;
				color: #aaa;
			}
			.matching-options-bank .drag-item {
				font-size: 15px;
				text-align: center;
				border: 1px solid #ccc;
				background: #f9f9f9;
			}

			.questions-panel {
				flex: 1;
				padding: 20px 20px 100px;
				overflow-y: auto;
				min-width: 200px; /* Minimum width */
				border-left: 1px solid #e0e0e0;
			}
			.matching-question-item.incorrect {
				background-color: #f8d7da;
				border-color: #dc3545 !important;
			}
			.summary-completion-container {
				margin-top: 20px;
			}
			.summary-text p {
				line-height: 2.5;
				font-size: 16px;
			}
			.summary-drop-zone {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				vertical-align: middle;
				max-width: 200px;
				height: 25px;
				border: 2px dashed #999;
				border-radius: 4px;
				margin: 0 5px;
				padding: 0 5px;
				transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
				color: #aaa;
				font-weight: bold;
			}
			.summary-drop-zone.filled {
				border-color: #4a90e2;
			}
			.summary-drop-zone.active-input {
				border-color: #4a90e2;
				box-shadow: none;
			}
			.summary-drop-zone .drag-item {
				font-size: 15px;
				font-weight: bold;
				background-color: transparent;
				border: none;
				padding: 0;
				text-align: center;
				width: 100%;
				height: 100%;
				display: flex;
				align-items: center;
				justify-content: center;
			}
			.summary-options-bank {
				display: flex;
				flex-wrap: wrap;
				gap: 10px;
				margin-top: 20px;
				padding: 10px;
				border: 1px solid #ddd;
				border-radius: 5px;
			}
			.summary-options-bank .drag-item {
				flex-grow: 1;
				min-width: 100px;
				text-align: center;
			}
			.multi-choice-question {
				margin-bottom: 20px;
				padding: 10px;
				border-radius: 4px;
				border: 3px solid transparent;
				transition: border-color 0.3s, background-color 0.3s;
			}
			.multi-choice-option {
				margin-bottom: 10px;
				padding: 8px;
				border-radius: 4px;
				transition: background-color 0.3s;
			}
			.multi-choice-option label {
				display: flex;
				align-items: center;
				cursor: pointer;
				font-size: 16px;
			}
			.multi-choice-option input[type='checkbox'],
			.multi-choice-option input[type='radio'] {
				margin-right: 12px;
				transform: scale(1.3);
				accent-color: #4a90e2;
			}
			.multi-choice-option.correct {
				background-color: #e9f7ef;
			}
			.multi-choice-option.incorrect {
				background-color: #f8d7da;
			}
			.matching-question-item.incorrect {
				background-color: #f8d7da;
				border-color: #dc3545 !important;
			}
			.matching-question-item .drop-zone.filled {
				border-color: #4a90e2;
			}
			.matching-question-item .drop-zone {
				width: 200px;
				height: 40px;
			}
			.paragraph-matching-question {
				align-items: center;
				justify-content: space-between;
				gap: 15px;
				margin-bottom: 12px;
			}
			.paragraph-matching-question .answer-input {
				width: 80px;
				flex-shrink: 0;
			}

			.matching-form-container {
				margin-top: 20px;
			}
			.matching-form-row {
				display: flex;
				align-items: center;
				margin-bottom: 12px;
			}
			.matching-form-label {
				flex-shrink: 0;
			}

			/* Results Modal */
			.modal-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-color: rgba(0, 0, 0, 0.7);
				z-index: 2000;
				display: flex;
				justify-content: center;
				align-items: center;
			}
			.modal-overlay.hidden {
				display: none;
			}
			.modal-content {
				background: white;
				padding: 25px;
				border-radius: 8px;
				width: 90%;
				max-width: 600px;
				max-height: 80vh;
				display: flex;
				flex-direction: column;
				position: relative;
			}
			.modal-close-btn {
				position: absolute;
				top: 10px;
				right: 15px;
				background: none;
				border: none;
				font-size: 28px;
				cursor: pointer;
				color: #888;
			}
			.modal-content h2 {
				text-align: center;
				margin-bottom: 15px;
				color: #333;
			}
			.results-summary {
				display: flex;
				justify-content: space-around;
				margin-bottom: 20px;
				font-size: 18px;
				font-weight: bold;
				text-align: center;
				border-bottom: 1px solid #eee;
				padding-bottom: 15px;
			}
			.results-details-container {
				overflow-y: auto;
				padding-right: 10px; /* For scrollbar */
			}
			.result-row {
				display: grid;
				grid-template-columns: 40px 1fr 1fr;
				gap: 15px;
				padding: 8px 5px;
				border-bottom: 1px solid #f0f0f0;
				font-size: 15px;
			}
			.result-row.incorrect {
				background-color: #f8d7da;
			}
			.result-row .q-num {
				font-weight: bold;
			}
			.result-row .user-ans {
				color: #555;
			}
			.result-row .correct-ans {
				color: #155724;
				font-weight: 500;
			}
			.correct-answer-display {
				font-weight: bold;
				color: #28a745;
				margin-left: 10px;
				font-size: 14px;
			}
			.correct-answer-highlight,
			.tf-option.correct-answer-highlight,
			.multi-choice-option.correct-answer-highlight {
				background-color: #d4edda !important;
				border: 1px solid #c3e6cb !important;
				border-radius: 4px;
				padding: 4px;
			}
			.correct-answer-highlight {
				background-color: #d4edda;
				border: 1px solid #c3e6cb;
				border-radius: 4px;
			}
			.centered-title {
				text-align: center;
				font-size: 50px;
				font-weight: bold;
				margin-bottom: 15px;
			}

			.matching-table {
				width: 100%;
				border-collapse: collapse;
				margin: 20px 0;
				font-size: 14px;
			}

			.matching-table th {
				background-color: #007bff;
				color: white;
				padding: 12px;
				text-align: center;
				font-weight: bold;
				border: 1px solid #ddd;
			}

			.matching-table td {
				padding: 12px;
				border: 1px solid #ddd;
				vertical-align: top;
			}

			.matching-table .statement {
				text-align: left;
				width: 60%;
			}

			.matching-table .table-radio {
				margin: 0;
				transform: scale(1.2);
			}

			.matching-table td:not(.statement) {
				text-align: center;
				width: 6.67%;
				min-width: 60px;
			}

			.matching-table th:not(:first-child) {
				width: 6.67%;
				min-width: 60px;
			}

			.matching-table td:not(.statement):has(input:checked) {
				background-color: #e3f2fd;
			}

			.matching-table input[type='radio']:checked {
				accent-color: #007bff;
			}

			.matching-table td.correct {
				background-color: #d4edda !important;
				border-color: #c3e6cb;
			}

			.matching-table td.incorrect {
				background-color: #f8d7da !important;
				border-color: #f5c6cb;
			}

			.matching-table td.correct-answer-highlight {
				background-color: #d4edda !important;
				border-color: #c3e6cb;
			}

			.matching-table .options-row {
				background-color: #f8f9fa;
				border-bottom: 2px solid #dee2e6;
			}

			.matching-table .options-row td {
				font-weight: 500;
				text-align: center;
				padding: 8px 12px;
				font-size: 13px;
			}

			.matching-table .options-row td:first-child {
				text-align: left;
				font-weight: normal;
			}

			.matching-table td.correct-answer-highlight {
				background-color: #d4edda !important;
				border-color: #c3e6cb;
			}

			.matching-table .clickable-cell {
				cursor: pointer;
				transition: background-color 0.2s ease;
				min-height: 40px;
				border: 1px solid #ddd;
				position: relative;
			}

			.matching-table .clickable-cell:hover {
				background-color: #f0f8ff;
				border-color: #007bff;
			}

			.matching-table .clickable-cell.selected {
				background-color: #e3f2fd;
			}

			.matching-table .clickable-cell.correct {
				background-color: #d4edda !important;
				border-color: #c3e6cb;
			}

			.matching-table .clickable-cell.incorrect {
				background-color: #f8d7da !important;
				border-color: #f5c6cb;
			}

			.matching-table .clickable-cell::after {
				content: '';
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				width: 8px;
				height: 8px;
				border-radius: 50%;
				background-color: transparent;
				transition: background-color 0.2s ease;
			}

			.matching-table .clickable-cell.selected::after {
			}

			/* Explanation Section Styles */
			.explanation-section {
				margin-top: 40px;
				padding: 20px;
				background-color: #f8f9fa;
				border-radius: 8px;
				border: 1px solid #e9ecef;
			}

			.explanation-section h3 {
				color: #333;
				margin-bottom: 20px;
				text-align: center;
				font-size: 20px;
				font-weight: bold;
			}

			.explanation-content p {
				margin-bottom: 15px;
				line-height: 1.6;
				font-size: 16px;
			}

			.explanation-content strong {
				color: #4a90e2;
				font-weight: 600;
			}

			#show-explanation-btn {
				background-color: #4a90e2;
				color: white;
				border: none;
				padding: 12px 24px;
				border-radius: 6px;
				font-size: 16px;
				font-weight: 600;
				cursor: pointer;
				transition: background-color 0.2s;
			}

			#show-explanation-btn:hover {
				background-color: #357abd;
			}
		</style>
	</head>
	<body>
		<div class="header">
			<div class="timer-container">
				<span class="timer-display">58:32</span>
				<div class="timer-controls">
					<button id="timer-toggle-btn" title="Pause/Resume Timer">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							height="24px"
							viewBox="0 0 24 24"
							width="24px"
						>
							<path d="M0 0h24v24H0V0z" fill="none"></path>
							<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>
						</svg>
					</button>
					<button id="timer-reset-btn" title="Reset Timer">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							height="24px"
							viewBox="0 0 24 24"
							width="24px"
						>
							<path d="M0 0h24v24H0V0z" fill="none"></path>
							<path
								d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"
							></path>
						</svg>
					</button>
				</div>
			</div>
			<a
				href="https://t.me/innovativenews"
				target="_blank"
				class="telegram-link"
			>
				Innovative Centre 
			</a>
		</div>

		<div class="main-container" id="main-container">
			<div id="passage-header-container">
				<div id="part-header-1" class="part-header">
					<p><strong>Part 1</strong></p>
					<p>Read the text and answer questions 1-13.</p>
				</div>
				<div id="part-header-2" class="part-header hidden">
					<p><strong>Part 2</strong></p>
					<p>Read the text and answer questions 14-26.</p>
				</div>
				<div id="part-header-3" class="part-header hidden">
					<p><strong>Part 3</strong></p>
					<p>Read the text and answer questions 27-40.</p>
				</div>
			</div>
			<div class="panels-container">
				<div class="passage-panel" id="passage-panel" style="flex: 0 0 631px">
					<div id="passage-text-1" class="reading-passage">
						<h4 class="text-center">Dirty river but clean water</h4>
						<p style="font-style: italic; text-align: center">
							Floods can occur in rivers when the flow rate exceeds the capacity
							of the river channel, particularly at bends or meanders in the
							waterway. Floods often cause damage to homes and businesses if
							they are in the natural flood plains of rivers. While riverine
							flood damage can be eliminated by moving away from rivers and
							other bodies of water, people have traditionally lived and worked
							by rivers because the land is usually flat and fertile and because
							rivers provide easy travel and access to commerce and industry.
						</p>
						<p>
							<strong>A</strong>&nbsp;&nbsp;FIRE and flood are two of humanity's
							worst nightmares. People have, therefore, always sought to control
							them. Forest fires are snuffed out quickly. The flow of rivers is
							regulated by weirs and dams. At least, that is how it used to be.
							But foresters have learned that forests need fires to clear out
							the brush and even to get seeds to germinate. And a similar
							revelation is now dawning on hydrologists. Rivers – and the
							ecosystems they support – need floods. That is why a man-made
							torrent has been surging down the Grand Canyon. By Thursday, March
							6th it was running at full throttle, which was expected to be
							sustained for 60 hours.
						</p>

						<p>
							<strong>B</strong>&nbsp;&nbsp;Floods once raged through the canyon
							every year. Spring Snow from as far away as Wyoming would melt and
							swell the Colorado river to a flow that averaged around 1,500
							cubic metres (50,000 cubic feet) a second. Every eight years or
							so, that figure rose to almost 3,000 cubic metres. These floods
							infused the river with sediment, carved its beaches and built its
							sandbars.
						</p>

						<p>
							<strong>C</strong>&nbsp;&nbsp;However, in the four decades since
							the building of the Glen Canyon dam, just upstream of the Grand
							Canyon, the only sediment that it has collected has come from
							tiny, undammed tributaries. Even that has not been much use as
							those tributaries are not powerful enough to distribute the
							sediment in an ecologically valuable way.
						</p>

						<p>
							<strong>D</strong>&nbsp;&nbsp;This lack of flooding has harmed
							local wildlife. The humpback chub, for example, thrived in the
							rust-red waters of Colorado. Recently, though, its population has
							crashed. At first sight, it looked as if the reason was that the
							chub were being eaten by trout introduced for sport fishing in the
							mid-20th century. But trout and chub co-existed until the Glen
							Canyon dam was built, so something else is going on. Steve Gloss,
							of the United States Geological Survey (USGS), reckons that the
							chub's decline is the result of their losing their most valuable
							natural defense, Colorado's rusty sediment. The chub were well
							adapted to the poor visibility created by the chick, red water
							which gave the river its name and depended on it to hide from
							predators. Without the cloudy water, the chub became vulnerable.
						</p>

						<p>
							<strong>E</strong>&nbsp;&nbsp;And the chub are not alone. In the
							years since the Glen Canyon dam was built, several species have
							vanished altogether. These include the Colorado pike-minnow, the
							razorback sucker and the roundtail chub. Meanwhile, aliens
							including fathead minnows, channel catfish and common carp, which
							would have been hard, put to survive in the savage waters of the
							undammed canyon, have moved in.
						</p>

						<p>
							<strong>F</strong>&nbsp;&nbsp;So flooding is the obvious answer.
							Unfortunately, it is easier said than done. Floods were sent down
							the Grand Canyon in 1996 and 2004 and the results were mixed. In
							1996 the flood was allowed to go on too long. To start with, all
							seemed well. The floodwaters built up sandbanks and infused the
							river with sediment. Eventually, however, the continued flow
							washed most of the sediment out of the canyon. This problem was
							avoided in 2004, but unfortunately, on that occasion, the volume
							of sand available behind the dam was too low to rebuild the
							sandbanks. This time, the USGS is convinced that things will be
							better. The amount of sediment available is three times greater
							than it was in 2004. So if a flood is going to do some good, this
							is the time to unleash one.
						</p>

						<p>
							<strong>G</strong>&nbsp;&nbsp;Even so, it may turn out to be an
							empty gesture. At less than 1,200 cubic metres a second, this
							flood is smaller than even an average spring flood, let alone one
							of the mightier deluges of the past. Those glorious inundations
							moved massive quantities of sediment through the Grand Canyon,
							wiping the slate dirty, and making a muddy mess of silt and muck
							that would make modern river rafters cringe.
						</p>
					</div>
					<div id="passage-text-2" class="reading-passage hidden">
						<h4 class="text-center">Memory and Age</h4>
						<p>
							<strong>A</strong>&nbsp;&nbsp;Aging, it is now clear, is part of
							an ongoing maturation process that all our organs go through. "In
							a sense, aging is keyed to the level of the vigor of the body and
							the continuous interaction between levels of body activity and
							levels of mental activity," reports Arnold B. Scheibel, M.D.,
							whose very academic title reflects how once far-flung domains now
							converge on the mind and the brain. Scheibel is a professor of
							anatomy, cell biology, psychiatry, and behavioral sciences at the
							University of California at Los Angeles, and director of
							university's Brain Research Institute. Experimental evidence has
							backed up popular assumptions that the aging mind undergoes decay
							analogous to that of the aging body. Younger monkeys, chimps, and
							lower animals consistently outperform their older colleagues on
							memory tests. In humans, psychologists concluded, memory and other
							mental functions deteriorate over time because of inevitable
							organic changes in the brain as neurons die off. The mental
							decline after young adulthood appeared inevitable.
						</p>

						<p>
							<strong>B</strong>&nbsp;&nbsp;Equipped with imaging techniques
							that capture the brain in action, Stanley Rapoport, Ph.D., at the
							National Institutes of Health, measured the flow of blood in the
							brains of old and young people as they went through the task of
							matching photos of faces. Since blood flow reflects neuronal
							activity, Rapoport could compare with networks of neurons were
							being used by different subjects. "Even when the reaction times of
							older and younger subjects were the same, the neural networks they
							used were significantly different. The older subjects were using
							different internal strategies to accomplish the same result in the
							same time," Rapoport says. Either the task required greater effort
							on the part of the older subjects or the work of neurons
							originally involved in tasks of that type had been taken over by
							other neurons, creating different networks.
						</p>

						<p>
							<strong>C</strong>&nbsp;&nbsp;At the Georgia Institute of
							Technology, psychologist Timothy Salthouse, Ph.D., compared a
							group of very fast and accurate typists of college-age with
							another group in their 60s. since reaction time is faster in
							younger people and most people's fingers grow less nimble with
							age, younger typists might be expected to tap right along while
							the older one's fumble. But both typed 60 words a minute. The
							older typists, it turned out, achieved their speed with cunning
							little strategies that made them far more efficient than their
							younger counterparts: They made fewer finger movements, saving a
							fraction of a second here and there. They also read ahead in the
							text. The neural networks involved in typing appear to have been
							reshaped to compensate for losses in motor skills or other age
							changes.
						</p>

						<p>
							<strong>D</strong>&nbsp;&nbsp;"When a rat is kept in isolation
							without playmates or objects to interact with, the animal's brain
							shrinks, but if we put that rat with 11 other rats in a large cage
							and give them an assortment of wheels, ladders, and other toys, we
							can show—after four days—significant differences in its brain,"
							says Diamond, professor of integrative biology. Proliferating
							dendrites first appear in the visual association areas. After a
							month in the enriched environment, the whole cerebral cortex has
							expanded, a has its blood supply. Even in the enriched
							environment, rats get bored unless the toys are varied. "Animals
							are just like we are. They need stimulation," says Diamond.
						</p>
						<p>
							One of the most profoundly important mental functions is
							memory-notorious for its failure with age. So important is a
							memory that the Charles A. Dana foundation recently spent $8.4
							million to set up a consortium of leading medical centers to
							measure memory loss and aging through brain-imaging technology,
							neurochemical experiment, and cognitive and psychological tests.
							One thing, however, is already fairly clear—many aspects of memory
							are not a function of age at all but of education. Memory exists
							in more than one form. What we call knowledge—facts—is what
							psychologists such as Harry P. Bahrick, Ph.D., of Ohio Wesleyan
							University call semantic memory. Events, conversations, and
							occurrences in time and space, on the other hand, make up episodic
							or event memory, which is triggered by cues from the context. If
							you were around in 1963 you don't need to be reminded of the
							circumstances surrounding the moment you heard that JFK had been
							assassinated. That event is etched into your episodic memory.
						</p>

						<p>
							<strong>E</strong>&nbsp;&nbsp;When you forget a less vivid item,
							like buying a roll of paper towels at the supermarket, you may
							blame it on your aging memory. It's true that episodic memory
							begins to decline when most people are in their 50s, but it's
							never perfect at any age. "Every memory begins as an event," says
							Bahrick. "Through repetition, certain events leave behind a
							residue of knowledge or semantic memory. On a specific day in the
							past, somebody taught you that two and two are four, but you've
							been over that information so often you don't remember where you
							learned it. What started as an episodic memory has become a
							permanent part of your knowledge base." You remember the content,
							not the context. Our language knowledge, our knowledge of the
							world and of people, is largely that permanent or semi-permanent
							residue.
						</p>

						<p>
							<strong>F</strong>&nbsp;&nbsp;Probing the longevity of knowledge,
							Bahrick tested 1,000 high school graduates to see how well they
							recalled their algebra. Some had completed the course as recently
							as a month before, others as long as 50 years earlier. He also
							determined how long each person had studied algebra, the grade
							received, and how much the skill was used over the course of
							adulthood. Surprisingly, a person's grasp of algebra at the time
							of testing did not depend on how long ago he'd taken the
							course—the determining factor was the duration of instruction.
							Those who had spent only a few months learning algebra forgot most
							of it within two or three years.
						</p>

						<p>
							<strong>G</strong>&nbsp;&nbsp;In another study, Bahrick discovered
							that people who had taken several courses in Spanish, spread out
							over a couple of years, could recall, decades later, 60 per cent
							or more of the vocabulary they learned. Those who took just one
							course retained only a trace after three years. "This long-term
							residue of knowledge remains stable over the decades, independent
							of the age of the person and the age of the memory. No serious
							deficit appears until people get to their 50s and 60s, probably
							due to the degenerative processes of aging rather than a cognitive
							loss."
						</p>

						<p>
							<strong>H</strong>&nbsp;&nbsp;"You could say metamemory is a
							byproduct of going to school," says psychologist Robert Kail,
							Ph.D., of Purdue University, who studies children from birth to 20
							years, the time of life when mental development is most rapid.
							"The question-and-answer process, especially exam-taking, helps
							children learn—and also teaches them how their memory works. This
							may be one reason why, according to a broad range of studies in
							people over 60, the better educated a person is, the more likely
							they are to perform better in life and on psychological tests. A
							group of adult novice chess players were compared with a group of
							child experts at the game. In tests of their ability to remember a
							random series of numbers, the adults, as expected, outscored the
							children. But when asked to remember the patterns of chess pieces
							arranged on a board, the children won. "Because they'd played a
							lot of chess, their knowledge of chess was better organized than
							that of the adults, and their existing knowledge of chess served
							as a framework for new memory," explains Kail.
						</p>

						<p>
							<strong>I</strong>&nbsp;&nbsp;Specialized knowledge is a mental
							resource that only improve with time. Crystallized intelligence
							about one's occupation apparently does not decline at all until at
							least age 75, and if there is no disease or dementia, may remain
							even longer. Special knowledge is often organized by a process
							called "chunking." If procedure A and procedure B are always done
							together, for example, the mind may merge them into a single
							command. When you apply yourself to a specific interest—say,
							cooking—you build increasingly elaborate knowledge structures that
							let you do more and do it better. This ability, which is tied to
							experience, is the essence of expertise. Vocabulary is one such
							specialized form of accrued knowledge. Research clearly shows that
							vocabulary improves with time. Retired professionals, especially
							teachers and journalists, consistently score higher on tests of
							vocabulary and general information than college students, who are
							supposed to be in their mental prime.
						</p>
					</div>
					<div id="passage-text-3" class="reading-passage hidden">
						<h4 class="text-center">Save Endangered Language</h4>
						<p style="font-style: italic; text-align: center; font-size: 16px">
							"Obviously we must do some serious rethinking of our priorities,
							lest linguistics go down in history as the only science that
							presided obviously over the disappearance of 90 percent of the
							very field to which it is dedicated." – Michael Krauss, "The
							World's Languages in Crisis".
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="27"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							27
						</div>
						<p>
							Ten years ago Michael Krauss sent a shudder through the discipline
							of linguistics with his prediction that half the 6,000 or so
							languages spoken in the world would cease to be uttered within a
							century. Unless scientists and community leaders directed a
							worldwide effort to stabilize the decline of local languages, he
							warned, nine-tenths of the linguistic diversity of humankind would
							probably be doomed to extinction. Krauss's prediction was little
							more than an educated guess, but other respected linguists had
							been clanging out similar alarms. Keneth L. Hale of the
							Massachusetts Institute of Technology noted in the same journal
							issue that eight languages on which he had done fieldwork had
							since passed into extinction. A 1990 survey in Australia found
							that 70 of the 90 surviving Aboriginal languages were no longer
							used regularly by all age groups. The same was true for all but 20
							of the 175 Native American languages spoken or remembered in the
							US., Krauss told a congressional panel in 1992.
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="28"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							28
						</div>
						<p>
							Many experts in the field mourn the loss of rare languages, for
							several reasons. To start, there is scientific self-interest: some
							of the most basic questions in linguistics have to do with the
							limits of human speech, which are far from fully explored. Many
							researchers would like to know which structural elements of
							grammar and vocabulary – if any – are truly universal and
							probably, therefore, hardwired into the human brain. Other
							scientists try to reconstruct ancient migration patterns by
							comparing borrowed words that appear in otherwise unrelated
							languages. In each of these cases, the wider the portfolio of
							languages you study, the more likely you are to get the right
							answers.
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
								background-color: #e9f7ef;
								border-color: #28a745;
								color: #155724;
							"
						>
							a period when there was absent of real effort made.
						</div>
						<p>
							Despite the near-constant buzz in linguistics about endangered
							languages over the past 10 years, the field has accomplished
							depressingly little. "You would think that there would be some
							organized response to this dire situation," some attempt to
							determine which language can be saved and which should be
							documented before they disappear, says Sarah G. Thomason, a
							linguist at the University of Michigan at Ann Arbor. "But there
							isn't any such effort organized in the profession. It is only
							recently that it has become fashionable enough to work on
							endangered languages." Six years ago, recalls Douglas H. Whalen of
							Yale University, "when I asked linguists who were raising money to
							deal with these problems, I mostly got blank stares." So Whalen
							and a few other linguists founded the Endangered Languages Fund.
							In the five years to 2001, they were able to collect only $80,000
							for research grants. A similar foundation in England, directed by
							Nicholas Ostler, has raised just $8,000 since 1995.
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="29"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							29
						</div>
						<p>
							But there are encouraging signs that the field has turned a
							corner. The Volkswagen Foundation, a German charity, just issued
							its second round of grants totaling more than $2 million. It has
							created a multimedia archive at the Max Planck Institute for
							Psycholinguistics in the Netherlands that can house recordings,
							grammars, dictionaries and other data on endangered languages. To
							fill the archive, the foundation has dispatched field linguists to
							document Aweti (100 or so speakers in Brazil), Ega (about 300
							speakers in Ivory Coast), Waima'a (a few hundred speakers in East
							Timor), and a dozen or so other languages unlikely to survive the
							century. The Ford Foundation has also edged into the arena. Its
							contributions helped to reinvigorate a master-apprentice program
							created in 1992 by Leanne Hinton of Berkeley and Native Americans
							worried about the imminent demise of about 50 indigenous languages
							in California. Fluent speakers receive $3,000 to teach a younger
							relative (who is also paid) their native tongue through 360 hours
							of shared activities, spread over six months. So far about 5 teams
							have completed the program, Hinton says, transmitting a least some
							knowledge of 25 languages. "It's too early to call this language
							revitalization," Hinton admits. "In California, the death rate of
							elderly speakers will always be greater than the recruitment rate
							of young speakers. But at least we prolong the survival of the
							language." That will give linguists more time to record these
							tongues before they vanish.
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="30"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							30
						</div>
						<p>
							But the master-apprentice approach hasn't caught on outside the
							U.S., and Hinton's effort is a drop in the sea. At least 440
							languages have been reduced to a mere handful of elders, according
							to the Ethnologue, a catalogue of languages produced by the
							Dallas-based group SIL International that comes closest to global
							coverage. For the vast majority of these languages, there is
							little or no record of their grammar, vocabulary, pronunciation or
							use in daily life. Even if a language has been fully documented,
							all that remains once it vanishes from active use is a fossil
							skeleton, a scattering of features that the scientist was lucky
							and astute enough to capture. Linguists may be able to sketch an
							outline of the forgotten language and fix its place on the
							evolutionary tree, but little more. "How did people start
							conversations and talk to babies? How dis husbands and wives
							converse?" Hinton asks. "Those are the first things you want to
							learn when you want to revitalize the language."
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="31"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							31
						</div>
						<p>
							But there is as yet no discipline of "conservation linguistics,"
							as there is for biology. Almost every strategy tried so far has
							succeeded in some places but failed in others, and there seems to
							be no way to predict with certainty what will work where. Twenty
							years ago in New Zealand, Maori speakers set up "language nests,"
							in which preschoolers were immersed in the native language.
							Additional Maori-only classes were added as the children
							progressed through elementary and secondary school. A similar
							approach was tried in Hawaii, with some success – the number of
							native speakers has stabilized at 1,000 or so, reports Joseph E.
							Grimes of SIL International, who is working on Oahu. Students can
							now get instruction in Hawaiian all the way through university.
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="32"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							32
						</div>
						<p>
							One factor that always seems to occur in the demise of a language
							is that the speakers begin to have collective doubts about the
							usefulness of language loyalty. Once they start regarding their
							own language as inferior to the majority language, people stop
							using it in all situations. Kids pick up on the attitude and
							prefer the dominant language. In many cases, people don't notice
							until they suddenly realize that their kids never speak the
							language, even at home. This is how Cornish and some dialects of
							Scottish Gaelic is still only rarely used for daily home life in
							Ireland, 80 years after the republic was founded with Irish as its
							first official language.
						</p>

						<div
							class="drop-zone"
							data-dnd-group="headings"
							data-q-start="33"
							style="
								margin: 10px 0;
								border: 2px dashed #999;
								border-radius: 4px;
								text-align: center;
								color: #aaa;
								font-weight: bold;
							"
						>
							33
						</div>
						<p>
							Linguists agree that ultimately, the answer to the problem of
							language extinction is multilingualism. Even uneducated people can
							learn several languages, as long as they start as children.
							Indeed, most people in the world speak more than one tongue, and
							in places such as Cameroon (279 languages), Papua New Guinea (823)
							and India (387) it is common to speak three of four distinct
							languages and a dialect or two as well. Most Americans and
							Canadians, to the west of Quebec, have a gut reaction that anyone
							speaking another language in front of them is committing an
							immoral act. You get the same reaction in Australia and Russia. It
							is no coincidence that these are the areas where languages are
							disappearing the fastest. The first step in saving dying languages
							is to persuade the world's majorities to allow the minorities
							among them to speak with their own voices.
						</p>
					</div>
				</div>
				<div class="resizer" id="resizer"></div>
				<div class="questions-panel" id="questions-panel">
					<div id="questions-1" class="question-set">
						<div class="questions-container">
							<div class="question" data-q-start="1" data-q-end="7">
								<div class="question-prompt">
									<p>
										<strong>Questions 1-7</strong><br />
										Do the following statements agree with the information given
										in Reading Passage 1?
									</p>
									<p>In boxes 1-7 on your answer sheet, write</p>
									<ul style="list-style: none; padding-left: 0">
										<li><strong>TRUE</strong> if the statement is true</li>
										<li><strong>FALSE</strong> if the statement is false</li>
										<li>
											<strong>NOT GIVEN</strong> if the information is not given
											in the passage
										</li>
									</ul>
								</div>
								<div class="tf-question" data-q-start="1" data-q-end="1">
									<div class="tf-question-line">
										<span class="tf-question-number">1</span
										><span class="tf-question-text"
											>Damage caused by a fire is worse than that caused by the
											flood.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q1" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q1" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q1" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
								<div class="tf-question" data-q-start="2" data-q-end="2">
									<div class="tf-question-line">
										<span class="tf-question-number">2</span
										><span class="tf-question-text"
											>The flood peaks at almost 1500 cubic meters every eight
											years.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q2" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q2" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q2" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
								<div class="tf-question" data-q-start="3" data-q-end="3">
									<div class="tf-question-line">
										<span class="tf-question-number">3</span
										><span class="tf-question-text"
											>Contribution of sediments delivered by tributaries has
											little impact.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q3" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q3" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q3" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
								<div class="tf-question" data-q-start="4" data-q-end="4">
									<div class="tf-question-line">
										<span class="tf-question-number">4</span
										><span class="tf-question-text"
											>The decreasing number of chubs is always caused by
											introducing of trout since the mid 20th century.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q4" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q4" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q4" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
								<div class="tf-question" data-q-start="5" data-q-end="5">
									<div class="tf-question-line">
										<span class="tf-question-number">5</span
										><span class="tf-question-text"
											>It seemed that the artificial flood in 1996 had achieved
											success partly at the very beginning.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q5" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q5" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q5" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
								<div class="tf-question" data-q-start="6" data-q-end="6">
									<div class="tf-question-line">
										<span class="tf-question-number">6</span
										><span class="tf-question-text"
											>In fact, the yield of artificial flood water is smaller
											than an average natural flood at present.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q6" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q6" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q6" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
								<div class="tf-question" data-q-start="7" data-q-end="7">
									<div class="tf-question-line">
										<span class="tf-question-number">7</span
										><span class="tf-question-text"
											>Mighty floods drove fast-moving flows with clean and
											high-quality water.</span
										>
									</div>
									<div class="tf-options">
										<label class="tf-option"
											><input type="radio" name="q7" value="TRUE" /> TRUE</label
										>
										<label class="tf-option"
											><input type="radio" name="q7" value="FALSE" />
											FALSE</label
										>
										<label class="tf-option"
											><input type="radio" name="q7" value="NOT GIVEN" /> NOT
											GIVEN</label
										>
									</div>
								</div>
							</div>
							<div class="question" data-q-start="8" data-q-end="13">
								<div class="question-prompt">
									<p>
										<strong>Questions 8-13</strong><br />
										Complete the summary below.
									</p>
									<p>
										Choose <strong>NO MORE THAN TWO WORDS</strong> from the
										passage for each answer.
									</p>
									<p>Write your answers in boxes 8-13 on your answer sheet.</p>
								</div>
								<div class="summary-text">
									<p><strong>The eco-impact of the Canyon Dam</strong></p>
									<p>
										Floods are people's nightmare. In the past, the canyon was
										raged by flood every year. The snow from far Wyoming would
										melt in the season of
										<input
											type="text"
											class="answer-input"
											id="q8"
											placeholder="8"
										/>
										and caused a flood flow peak in Colorado river. In the four
										decades after people built the Glen Canyon Dam, it only
										could gather
										<input
											type="text"
											class="answer-input"
											id="q9"
											placeholder="9"
										/>
										together from tiny, undammed tributaries.
									</p>
									<p><strong>humpback chub population reduced, why?</strong></p>
									<p>
										Then several species disappeared including Colorado
										pike-minnow,
										<input
											type="text"
											class="answer-input"
											id="q10"
											placeholder="10"
										/>
										and the round-tail chub. Meanwhile, some moved in such as
										fathead minnows, channel catfish and
										<input
											type="text"
											class="answer-input"
											id="q11"
											placeholder="11"
										/>. The non-stopped flow led to the washing away of the
										sediment out of the canyon, which poses a great threat to
										the chubs because it has poor
										<input
											type="text"
											class="answer-input"
											id="q12"
											placeholder="12"
										/>
										away from predators. In addition, the volume of
										<input
											type="text"
											class="answer-input"
											id="q13"
											placeholder="13"
										/>
										available behind the dam was too low to rebuild the bars and
										flooding became more serious.
									</p>
								</div>
							</div>
						</div>
					</div>
					<div id="questions-2" class="question-set hidden">
						<div class="questions-container">
							<div class="question" data-q-start="14" data-q-end="17">
								<div class="question-prompt">
									<p>
										<strong>Questions 14-17</strong><br />Choose the correct
										answer.
									</p>
									<p>Write your answers in boxes 14-17 on your answer sheet.</p>
								</div>
								<div
									class="multi-choice-question"
									data-q-start="14"
									data-q-end="14"
								>
									<div class="question-prompt">
										<p>
											<strong>14</strong> What does the experiment of typist
											show in the passage?
										</p>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q14" value="A" /> Old people
											reading ability is superior</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q14" value="B" /> Losses of age
											is irreversible</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q14" value="C" /> Seasoned
											tactics made elders more efficient</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q14" value="D" /> Old people
											performed poorly in the driving test</label
										>
									</div>
								</div>
								<div
									class="multi-choice-question"
									data-q-start="15"
									data-q-end="15"
								>
									<div class="question-prompt">
										<p>
											<strong>15</strong> Which is correct about rat experiment?
										</p>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q15" value="A" /> Different
											toys have a different effect on rats</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q15" value="B" /> Rat's brain
											weight increased in both cages</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q15" value="C" /> Isolated
											rat's brain grows new connections</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q15" value="D" /> Boring and
											complicated surroundings affect brain development</label
										>
									</div>
								</div>
								<div
									class="multi-choice-question"
									data-q-start="16"
									data-q-end="16"
								>
									<div class="question-prompt">
										<p>
											<strong>16</strong> What can be concluded in a chess game
											of children group?
										</p>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q16" value="A" /> They won a
											game with adults</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q16" value="B" /> Their
											organization of chess knowledge is better</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q16" value="C" /> Their image
											memory is better than adults</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q16" value="D" /> They used a
											different part of the brain when playing chess</label
										>
									</div>
								</div>
								<div
									class="multi-choice-question"
									data-q-start="17"
									data-q-end="17"
								>
									<div class="question-prompt">
										<p>
											<strong>17</strong> What is the author's purpose of using
											"vocabulary study" at the end of the passage?
										</p>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q17" value="A" /> Certain
											people are sensitive to vocabularies while others
											aren't</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q17" value="B" /> Teachers and
											professionals won by their experience</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q17" value="C" /> Vocabulary
											memory as a crystallized intelligence is hard to
											decline</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q17" value="D" /> Old people
											use their special zone of the brain when the study</label
										>
									</div>
								</div>
							</div>
							<div class="question" data-q-start="18" data-q-end="23">
								<div class="question-prompt">
									<p><strong>Question 18-23</strong></p>
									<p>
										Complete the following summary of the paragraphs of Reading
										Passage
									</p>
									<p>
										Using <strong>NO MORE THAN TWO WORDS</strong> from the
										Reading Passage for each answer.
									</p>
									<p>Write your answers in boxes 18-23 on your answer sheet.</p>
								</div>
								<div class="summary-text">
									<p>
										It's long been known that as one significant mental
										function,
										<input
											type="text"
											class="answer-input"
											id="q18"
											placeholder="18"
										/>
										deteriorates with age. Charles A. Dana foundation invested
										millions of dollars to test memory decline. They used
										advanced technology, neurochemical experiments and ran
										several cognitive and
										<input
											type="text"
											class="answer-input"
											id="q19"
											placeholder="19"
										/>
										experiments. Bahrick called one form "<input
											type="text"
											class="answer-input"
											id="q20"
											placeholder="20"
										/>", which describes factual knowledge. Another one called
										"<input
											type="text"
											class="answer-input"
											id="q21"
											placeholder="21"
										/>" contains events in time and space format. He conducted
										two experiments toward to knowledge memory's longevity, he
										asked 1000 candidates some knowledge of
										<input
											type="text"
											class="answer-input"
											id="q22"
											placeholder="22"
										/>, some could even remember it decades ago. Second research
										of Spanish course found that multiple courses participants
										could remember more than half of
										<input
											type="text"
											class="answer-input"
											id="q23"
											placeholder="23"
										/>
										they learned after decades, whereas single course taker only
										remembered as short as 3 years.
									</p>
								</div>
							</div>
							<div class="question" data-q-start="24" data-q-end="27">
								<div class="question-prompt">
									<p>
										<strong>Questions 24-26</strong><br />Use the information in
										the passage to match the people (listed
										<strong>A-F</strong>) with opinions or deeds below.
									</p>
									<p>
										Write the appropriate letters <strong>A-F</strong> in boxes
										24-26 on your answer sheet.
									</p>
									<p><strong>A</strong> Harry P. Bahrick</p>
									<p><strong>B</strong> Arnold B. Scheibel</p>
									<p><strong>C</strong> Marion Diamond</p>
									<p><strong>D</strong> Timothy Salthouse</p>
									<p><strong>E</strong> Stanley Rapport</p>
									<p><strong>F</strong> Robert Kail</p>
								</div>
								<div class="table-container">
									<table class="matching-table">
										<thead>
											<tr>
												<th></th>
												<th>A</th>
												<th>B</th>
												<th>C</th>
												<th>D</th>
												<th>E</th>
												<th>F</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td class="statement">
													24. Examined both young and old's blood circulation of
													the brain while testing
												</td>
												<td
													class="clickable-cell"
													data-question="24"
													data-value="A"
													onclick="selectCell(this, 24, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="24"
													data-value="B"
													onclick="selectCell(this, 24, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="24"
													data-value="C"
													onclick="selectCell(this, 24, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="24"
													data-value="D"
													onclick="selectCell(this, 24, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="24"
													data-value="E"
													onclick="selectCell(this, 24, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="24"
													data-value="F"
													onclick="selectCell(this, 24, 'F')"
												></td>
											</tr>
											<tr>
												<td class="statement">
													25. Aging is a significant link between physical and
													mental activity
												</td>
												<td
													class="clickable-cell"
													data-question="25"
													data-value="A"
													onclick="selectCell(this, 25, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="25"
													data-value="B"
													onclick="selectCell(this, 25, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="25"
													data-value="C"
													onclick="selectCell(this, 25, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="25"
													data-value="D"
													onclick="selectCell(this, 25, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="25"
													data-value="E"
													onclick="selectCell(this, 25, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="25"
													data-value="F"
													onclick="selectCell(this, 25, 'F')"
												></td>
											</tr>
											<tr>
												<td class="statement">
													26. Some semantic memory of an event would not fade
													away after repetition
												</td>
												<td
													class="clickable-cell"
													data-question="26"
													data-value="A"
													onclick="selectCell(this, 26, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="26"
													data-value="B"
													onclick="selectCell(this, 26, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="26"
													data-value="C"
													onclick="selectCell(this, 26, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="26"
													data-value="D"
													onclick="selectCell(this, 26, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="26"
													data-value="E"
													onclick="selectCell(this, 26, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="26"
													data-value="F"
													onclick="selectCell(this, 26, 'F')"
												></td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
					<div id="questions-3" class="question-set hidden">
						<div class="questions-container">
							<div class="question" data-q-start="27" data-q-end="33">
								<div class="question-prompt">
									<p>
										<strong>Questions 27-33</strong><br />The reading passage
										has eight paragraphs.
									</p>
									<p>
										Choose the correct heading for paragraphs from the list
										below.
									</p>
								</div>
								<div class="drag-drop-container">
									<div class="recommendations-box">
										<h4>List of headings</h4>
										<div
											class="drag-item"
											draggable="true"
											data-value="i"
											data-dnd-group="headings"
										>
											data consistency needed for language
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="ii"
											data-dnd-group="headings"
										>
											consensuses on an initial recommendation for saving dying
											out languages
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="iii"
											data-dnd-group="headings"
										>
											positive gains for protection
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="iv"
											data-dnd-group="headings"
										>
											minimum requirement for saving a language
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="v"
											data-dnd-group="headings"
										>
											Potential threat to minority language
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="vi"
											data-dnd-group="headings"
										>
											a period when there was absent of real effort made
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="vii"
											data-dnd-group="headings"
										>
											native language programs launched
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="viii"
											data-dnd-group="headings"
										>
											Lack of confidence in young speakers as a negative factor
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="ix"
											data-dnd-group="headings"
										>
											Practise in several developing countries
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="x"
											data-dnd-group="headings"
										>
											Value of minority language to linguists
										</div>
										<div
											class="drag-item"
											draggable="true"
											data-value="xi"
											data-dnd-group="headings"
										>
											government participation in the language field
										</div>
									</div>
								</div>
							</div>
							<div class="question" data-q-start="34" data-q-end="38">
								<div class="question-prompt">
									<p>
										<strong>Questions 34-38</strong><br />Use the information in
										the passage to match the people (listed
										<strong>A-F</strong>) with opinions or deeds below.
									</p>
									<p>
										Write the appropriate letters <strong>A-F</strong> in boxes
										34-38 on your answer sheet.
									</p>
									<p><strong>A</strong> Nicholas Ostler</p>
									<p><strong>B</strong> Michael Krauss</p>
									<p><strong>C</strong> Joseph E. Grimes</p>
									<p><strong>D</strong> Sarah G. Thomason</p>
									<p><strong>E</strong> Keneth L. Hale</p>
									<p><strong>F</strong> Douglas H. Whalen</p>
								</div>
								<div class="table-container">
									<table class="matching-table">
										<thead>
											<tr>
												<th></th>
												<th>A</th>
												<th>B</th>
												<th>C</th>
												<th>D</th>
												<th>E</th>
												<th>F</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td class="statement">
													34. Reported language conservation practice in Hawaii
												</td>
												<td
													class="clickable-cell"
													data-question="34"
													data-value="A"
													onclick="selectCell(this, 34, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="34"
													data-value="B"
													onclick="selectCell(this, 34, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="34"
													data-value="C"
													onclick="selectCell(this, 34, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="34"
													data-value="D"
													onclick="selectCell(this, 34, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="34"
													data-value="E"
													onclick="selectCell(this, 34, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="34"
													data-value="F"
													onclick="selectCell(this, 34, 'F')"
												></td>
											</tr>
											<tr>
												<td class="statement">
													35. Predicted that many languages would disappear soon
												</td>
												<td
													class="clickable-cell"
													data-question="35"
													data-value="A"
													onclick="selectCell(this, 35, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="35"
													data-value="B"
													onclick="selectCell(this, 35, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="35"
													data-value="C"
													onclick="selectCell(this, 35, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="35"
													data-value="D"
													onclick="selectCell(this, 35, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="35"
													data-value="E"
													onclick="selectCell(this, 35, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="35"
													data-value="F"
													onclick="selectCell(this, 35, 'F')"
												></td>
											</tr>
											<tr>
												<td class="statement">
													36. The experienced process that languages die out
													personally
												</td>
												<td
													class="clickable-cell"
													data-question="36"
													data-value="A"
													onclick="selectCell(this, 36, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="36"
													data-value="B"
													onclick="selectCell(this, 36, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="36"
													data-value="C"
													onclick="selectCell(this, 36, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="36"
													data-value="D"
													onclick="selectCell(this, 36, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="36"
													data-value="E"
													onclick="selectCell(this, 36, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="36"
													data-value="F"
													onclick="selectCell(this, 36, 'F')"
												></td>
											</tr>
											<tr>
												<td class="statement">
													37. Raised language fund in England
												</td>
												<td
													class="clickable-cell"
													data-question="37"
													data-value="A"
													onclick="selectCell(this, 37, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="37"
													data-value="B"
													onclick="selectCell(this, 37, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="37"
													data-value="C"
													onclick="selectCell(this, 37, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="37"
													data-value="D"
													onclick="selectCell(this, 37, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="37"
													data-value="E"
													onclick="selectCell(this, 37, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="37"
													data-value="F"
													onclick="selectCell(this, 37, 'F')"
												></td>
											</tr>
											<tr>
												<td class="statement">
													38. Not enough effort on saving until recent work
												</td>
												<td
													class="clickable-cell"
													data-question="38"
													data-value="A"
													onclick="selectCell(this, 38, 'A')"
												></td>
												<td
													class="clickable-cell"
													data-question="38"
													data-value="B"
													onclick="selectCell(this, 38, 'B')"
												></td>
												<td
													class="clickable-cell"
													data-question="38"
													data-value="C"
													onclick="selectCell(this, 38, 'C')"
												></td>
												<td
													class="clickable-cell"
													data-question="38"
													data-value="D"
													onclick="selectCell(this, 38, 'D')"
												></td>
												<td
													class="clickable-cell"
													data-question="38"
													data-value="E"
													onclick="selectCell(this, 38, 'E')"
												></td>
												<td
													class="clickable-cell"
													data-question="38"
													data-value="F"
													onclick="selectCell(this, 38, 'F')"
												></td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
							<div class="question" data-q-start="39" data-q-end="40">
								<div class="question-prompt">
									<p>
										<strong>Questions 39-40</strong><br />Choose the correct
										answer.
									</p>
									<p>Write your answers in boxes 39-40 on your answer sheet.</p>
								</div>
								<div
									class="multi-choice-question"
									data-q-start="39"
									data-q-end="39"
								>
									<div class="question-prompt">
										<p>
											<strong>39</strong> What is the real result of a
											master-apprentice program sponsored by The Ford
											Foundation?
										</p>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q39" value="A" /> Teach
											children how to speak</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q39" value="B" /> Revive some
											endangered languages in California</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q39" value="C" /> Postpone the
											dying date for some endangered languages</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q39" value="D" /> Increase
											communication between students</label
										>
									</div>
								</div>
								<div
									class="multi-choice-question"
									data-q-start="40"
									data-q-end="40"
								>
									<div class="question-prompt">
										<p>
											<strong>40</strong> What should the majority language
											speakers do according to the last paragraph?
										</p>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q40" value="A" /> They should
											teach their children endangered language in free
											lessons</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q40" value="B" /> They should
											learn at least four languages</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q40" value="C" /> They should
											now their loyalty to a dying language</label
										>
									</div>
									<div class="multi-choice-option">
										<label
											><input type="radio" name="q40" value="D" /> They should
											be more tolerant of minority language speaker</label
										>
									</div>
								</div>
							</div>
						</div>
					</div>

					<!-- Explanation Button -->

					<!-- Part 2 Explanation Section -->
					<div
						id="part-2-explanation"
						class="explanation-section hidden"
						style="
							margin-top: 40px;
							padding: 20px;
							background-color: #f8f9fa;
							border-radius: 8px;
							border: 1px solid #e9ecef;
						"
					>
						<h3 style="color: #333; margin-bottom: 20px; text-align: center">
							Part 2 Explanation
						</h3>
						<div class="explanation-content">
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 14:</strong> "When a rocket made by Space X in
								Hawthorne, California…" - This passage directly mentions Space X
								and Hawthorne, California, which corresponds to the answer
								"Space X".
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 15:</strong> "Virgin Galactic started a
								business with the US National Oceanic and Atmospheric
								Administration which will be accepted by US scientists as a way
								of researching climate change using a spacecraft." - This
								passage mentions US scientists working with the National Oceanic
								and Atmospheric Administration, corresponding to the answer "US
								scientists".
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 16:</strong> "It displayed slick promotional
								videos, and models of the 'Nearly Ready' spacecraft in orbit…" -
								This passage mentions the "Nearly Ready" spacecraft, which is
								the answer for question 16.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 17:</strong> "…there need to be enforceable
								regulations in place to guarantee the safety of a civilian
								spacecraft." - This passage discusses the need for safety
								regulations, corresponding to the answer "safety".
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 18:</strong> "One way companies are planning to
								transport tourists into space is with a 'mother ship', an
								aircraft which carries a rocket…" - This passage mentions the
								"mother ship" concept, which is the answer for question 18.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 19:</strong> "…lawyers cannot agree on whether
								it is a plane or a rocket." - This passage mentions the legal
								uncertainty about whether it's a plane or rocket, corresponding
								to the answer "plane".
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 20:</strong> "The other aspects of the UN's
								1967 treaty for outer space exploration may be discussed again
								if civilian space flight turns out to be successful." - This
								passage mentions the UN's 1967 treaty, which is the answer for
								question 20.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 21:</strong> "…they have already had the
								experience of dealing with a tragedy. Unfortunately, three
								engineers were killed…" - This passage discusses the tragedy and
								the three engineers who were killed, which relates to the
								matching question about scientists who experienced tragedy.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 22:</strong> "…other critical safety factors
								are with depressurization risks, passengers close to the
								engine…" - This passage discusses safety factors and risks,
								which relates to the matching question about safety concerns.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 23:</strong> "…the VSH will equip an ejector
								seat for all tourists and staff." - This passage mentions the
								ejector seat safety feature, which relates to the matching
								question about safety equipment.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 24:</strong> "…the civilian space flight
								regulation must not 'stifle' the developing technologies with
								inconvenient rules." - This passage discusses regulations and
								their impact on technology development, which relates to the
								matching question about regulatory concerns.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 25:</strong> "…will leave a commercial space
								flight in the dangerous activity categories in terms of the
								insurance." - This passage discusses insurance and risk
								categorization, which relates to the matching question about
								financial and insurance matters.
							</p>
							<p style="margin-bottom: 15px; line-height: 1.6">
								<strong>Question 26:</strong> "Critics who are developing safety
								standards also insist…" - This passage mentions critics and
								safety standards, which relates to the matching question about
								safety standards development.
							</p>
						</div>

						<!-- Explanation Button for Part 3 -->
						<div style="text-align: center; margin-top: 30px">
							<button
								id="show-explanation-btn-part3"
								onclick="toggleExplanationPart3()"
								style="
									background-color: rgb(74, 144, 226);
									color: white;
									border: none;
									padding: 12px 24px;
									border-radius: 6px;
									font-size: 16px;
									font-weight: 600;
									cursor: pointer;
									transition: background-color 0.2s;
									display: none;
								"
							>
								Show Explanation
							</button>
						</div>

						<!-- Part 3 Explanation Section -->
						<div
							id="part-3-explanation"
							class="explanation-section hidden"
							style="
								margin-top: 40px;
								padding: 20px;
								background-color: #f8f9fa;
								border-radius: 8px;
								border: 1px solid #e9ecef;
							"
						>
							<h3 style="color: #333; margin-bottom: 20px; text-align: center">
								Part 3 Explanation
							</h3>
							<div class="explanation-content">
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 27:</strong> "It is tempting to think that
									the conservation of coral reefs and rainforests is a separate
									issue from traffic and air pollution. But it is not..." - This
									passage introduces the connection between environmental
									conservation and traffic pollution, which relates to the
									heading about a holistic view of climatic change.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 28:</strong> "The United Nation's Climate
									Change Panel has estimated that the global average temperature
									rise expected by the year 2100 could be as much as 6°C…" -
									This passage discusses negative predictions about climate
									change, which corresponds to the heading about negative
									predictions from experts.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 29:</strong> "This was actually invented in
									the late nineteenth century, but because the world's motor
									industry put its effort into developing the combustion
									engine…" - This passage discusses the history of fuel-cell
									technology, which corresponds to the heading about the history
									of fuel-cell technology.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 30:</strong> "Hydrogen goes into the fuel
									tank, producing electricity. The only emission from the
									exhaust pipe is water. The fuel-cell is, in some ways similar
									to a battery…" - This passage explains how the new vehicle
									technology works, which corresponds to the heading about how
									the new vehicle technology works.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 31:</strong> "One source of hydrogen is
									water. But to exploit the abundant resource, electricity is
									needed… Another source of hydrogen is, however, available…" -
									This passage discusses locating the essential ingredient
									(hydrogen), which corresponds to the heading about locating
									the essential ingredient.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 32:</strong> "Even now, fuel-cell buses are
									operating in the US, while in Germany a courier company is
									planning to take delivery of fuel-cell-powered vans…" - This
									passage discusses making the new technology available
									worldwide, which corresponds to the heading about making the
									new technology available worldwide.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 33:</strong> "…the world's motor industry put
									its effort into developing the combustion engine, it was never
									refined for mass production." - This passage mentions the
									combustion engine that the car industry invested in
									developing, which is the answer for question 33.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 34:</strong> "Ford engineers expect to be
									able to produce a virtually silent vehicle in the future." -
									This passage mentions Ford engineers predicting they will
									design an almost silent car, which is the answer for question
									34.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 35:</strong> "The fuel-cell is, in some ways
									similar to a battery, but unlike a battery, it does not run
									down." - This passage compares fuel-cells to batteries, which
									is the answer for question 35.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 36:</strong> "Fuel-cells can be made in a
									huge range of size, small enough for portable computers or
									large enough for power stations." - This passage mentions that
									fuel-cells can be used in power stations and portable
									computers, which is the answer for question 36.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 37:</strong> "…if the electricity is produced
									by a coal-fired power station or other fossil fuel, then the
									overall carbon reduction benefit of the fuel-cell disappears."
									- This passage states that using fossil fuels to produce
									electricity may increase the positive effect of the fuel-cell,
									which corresponds to the FALSE answer.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 38:</strong> "Oil companies, such as Norway's
									Statoil, are experimenting with storing carbon dioxide below
									ground in oil and gas wells." - This passage mentions Statoil
									in Norway but doesn't specify if they own gas wells in other
									parts of the world, which corresponds to the NOT GIVEN answer.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 39:</strong> "Even now, fuel-cell buses are
									operating in the US, while in Germany a courier company is
									planning to take delivery of fuel-cell-powered vans…" - This
									passage shows that public transport is leading the way in
									fuel-cell technology application, which corresponds to the
									TRUE answer.
								</p>
								<p style="margin-bottom: 15px; line-height: 1.6">
									<strong>Question 40:</strong> "This technology could have a
									major impact in slowing down climate change, but further
									investment is needed…" - This passage states that more funding
									is necessary for the fuel-cell vehicle industry, which
									corresponds to the TRUE answer.
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Navigation Arrows -->
		<div class="nav-arrows">
			<button class="nav-arrow" onclick="previousQuestion()" id="prevBtn">
				‹
			</button>
			<button class="nav-arrow" onclick="nextQuestion()" id="nextBtn">›</button>
		</div>

		<!-- Bottom Navigation -->
		<nav class="nav-row perScorableItem" aria-label="Questions">
			<div
				class="footer__questionWrapper___1tZ46 multiple selected"
				role="tablist"
			>
				<button
					role="tab"
					class="footer__questionNo___3WNct"
					onclick="switchToPart(1)"
				>
					<span>
						<span aria-hidden="true" class="section-prefix">Part </span>
						<span class="sectionNr" aria-hidden="true">1</span>
						<span class="attemptedCount" aria-hidden="true">0 of 13</span>
					</span>
				</button>
				<div class="footer__subquestionWrapper___9GgoP">
					<button class="subQuestion scorable-item" onclick="goToQuestion(1)">
						<span class="sr-only">Question 1</span
						><span aria-hidden="true">1</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(2)">
						<span class="sr-only">Question 2</span
						><span aria-hidden="true">2</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(3)">
						<span class="sr-only">Question 3</span
						><span aria-hidden="true">3</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(4)">
						<span class="sr-only">Question 4</span
						><span aria-hidden="true">4</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(5)">
						<span class="sr-only">Question 5</span
						><span aria-hidden="true">5</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(6)">
						<span class="sr-only">Question 6</span
						><span aria-hidden="true">6</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(7)">
						<span class="sr-only">Question 7</span
						><span aria-hidden="true">7</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(8)">
						<span class="sr-only">Question 8</span
						><span aria-hidden="true">8</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(9)">
						<span class="sr-only">Question 9</span
						><span aria-hidden="true">9</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(10)">
						<span class="sr-only">Question 10</span
						><span aria-hidden="true">10</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(11)">
						<span class="sr-only">Question 11</span
						><span aria-hidden="true">11</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(12)">
						<span class="sr-only">Question 12</span
						><span aria-hidden="true">12</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(13)">
						<span class="sr-only">Question 13</span
						><span aria-hidden="true">13</span>
					</button>
				</div>
			</div>

			<div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
				<button
					role="tab"
					class="footer__questionNo___3WNct"
					onclick="switchToPart(2)"
				>
					<span>
						<span aria-hidden="true" class="section-prefix">Part </span>
						<span class="sectionNr" aria-hidden="true">2</span>
						<span class="attemptedCount" aria-hidden="true">0 of 13</span>
					</span>
				</button>
				<div class="footer__subquestionWrapper___9GgoP">
					<button class="subQuestion scorable-item" onclick="goToQuestion(14)">
						<span class="sr-only">Question 14</span
						><span aria-hidden="true">14</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(15)">
						<span class="sr-only">Question 15</span
						><span aria-hidden="true">15</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(16)">
						<span class="sr-only">Question 16</span
						><span aria-hidden="true">16</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(17)">
						<span class="sr-only">Question 17</span
						><span aria-hidden="true">17</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(18)">
						<span class="sr-only">Question 18</span
						><span aria-hidden="true">18</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(19)">
						<span class="sr-only">Question 19</span
						><span aria-hidden="true">19</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(20)">
						<span class="sr-only">Question 20</span
						><span aria-hidden="true">20</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(21)">
						<span class="sr-only">Question 21</span
						><span aria-hidden="true">21</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(22)">
						<span class="sr-only">Question 22</span
						><span aria-hidden="true">22</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(23)">
						<span class="sr-only">Question 23</span
						><span aria-hidden="true">23</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(24)">
						<span class="sr-only">Question 24</span
						><span aria-hidden="true">24</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(25)">
						<span class="sr-only">Question 25</span
						><span aria-hidden="true">25</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(26)">
						<span class="sr-only">Question 26</span
						><span aria-hidden="true">26</span>
					</button>
				</div>
			</div>

			<div class="footer__questionWrapper___1tZ46 multiple" role="tablist">
				<button
					role="tab"
					class="footer__questionNo___3WNct"
					onclick="switchToPart(3)"
				>
					<span>
						<span aria-hidden="true" class="section-prefix">Part </span>
						<span class="sectionNr" aria-hidden="true">3</span>
						<span class="attemptedCount" aria-hidden="true">0 of 14</span>
					</span>
				</button>
				<div class="footer__subquestionWrapper___9GgoP">
					<button class="subQuestion scorable-item" onclick="goToQuestion(27)">
						<span class="sr-only">Question 27</span
						><span aria-hidden="true">27</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(28)">
						<span class="sr-only">Question 28</span
						><span aria-hidden="true">28</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(29)">
						<span class="sr-only">Question 29</span
						><span aria-hidden="true">29</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(30)">
						<span class="sr-only">Question 30</span
						><span aria-hidden="true">30</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(31)">
						<span class="sr-only">Question 31</span
						><span aria-hidden="true">31</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(32)">
						<span class="sr-only">Question 32</span
						><span aria-hidden="true">32</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(33)">
						<span class="sr-only">Question 33</span
						><span aria-hidden="true">33</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(34)">
						<span class="sr-only">Question 34</span
						><span aria-hidden="true">34</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(35)">
						<span class="sr-only">Question 35</span
						><span aria-hidden="true">35</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(36)">
						<span class="sr-only">Question 36</span
						><span aria-hidden="true">36</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(37)">
						<span class="sr-only">Question 37</span
						><span aria-hidden="true">37</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(38)">
						<span class="sr-only">Question 38</span
						><span aria-hidden="true">38</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(39)">
						<span class="sr-only">Question 39</span
						><span aria-hidden="true">39</span>
					</button>
					<button class="subQuestion scorable-item" onclick="goToQuestion(40)">
						<span class="sr-only">Question 40</span
						><span aria-hidden="true">40</span>
					</button>
				</div>
			</div>

			<button
				id="deliver-button"
				aria-label="Review your answers"
				class="footer__deliverButton___3FM07"
			>
				<i class="fa fa fa-check" aria-hidden="true"></i>
				<span>Check Answers</span>
			</button>
		</nav>

		<!-- Context Menu -->
		<div id="contextMenu" class="context-menu">
			<div
				id="menu-highlight"
				class="context-menu-item"
				onclick="highlightText()"
			>
				Highlight
			</div>
			<div id="menu-note" class="context-menu-item" onclick="addNote()">
				Note
			</div>
			<div id="menu-clear" class="context-menu-item" onclick="clearHighlight()">
				Clear
			</div>
			<div
				id="menu-clear-all"
				class="context-menu-item"
				onclick="clearAllHighlights()"
			>
				Clear All
			</div>
		</div>

		<div id="results-modal" class="modal-overlay hidden">
			<div class="modal-content">
				<button class="modal-close-btn" onclick="closeResultsModal()">×</button>
				<h2>Results</h2>
				<div class="results-summary">
					<p>Score: <span id="results-score"></span> / 40</p>
					<p>IELTS Band: <span id="results-band"></span></p>
				</div>
				<div id="results-details" class="results-details-container">
					<!-- Results for each question will be injected here -->
				</div>
			</div>
		</div>

		<script>
			document.addEventListener('DOMContentLoaded', () => {
				// --- STATE VARIABLES ---
				let currentPassage = 1
				let currentQuestion = 1
				let selectedRange = null
				let timeInSeconds = 3600
				let timerInterval
				let draggedItem = null
				let activeQuestionElement = null
				let selectedDragItem = null

				// --- GLOBAL FUNCTIONS ---
				function getFirstQuestionOfPart(part) {
					switch (part) {
						case 1:
							return 1
						case 2:
							return 14
						case 3:
							return 27
						default:
							return 1
					}
				}

				// --- DOM ELEMENTS ---
				const timerDisplay = document.querySelector('.timer-display')
				const timerToggleButton = document.getElementById('timer-toggle-btn')
				const timerResetButton = document.getElementById('timer-reset-btn')
				const deliverButton = document.getElementById('deliver-button')
				const resizer = document.getElementById('resizer')
				const passagePanel = document.getElementById('passage-panel')
				const questionsPanel = document.getElementById('questions-panel')
				const contextMenu = document.getElementById('contextMenu')

				// --- ICON SVGs ---
				const playIcon =
					'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M8 5v14l11-7L8 5z"/></svg>'
				const pauseIcon =
					'<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>'

				// --- ANSWERS ---
				const correctAnswers = {
					1: 'NOT GIVEN',
					2: 'FALSE',
					3: 'NOT GIVEN',
					4: 'FALSE',
					5: 'TRUE',
					6: 'TRUE',
					7: 'NOT GIVEN',
					8: 'spring',
					9: 'sediment',
					10: 'razorback sucker',
					11: 'common carp',
					12: 'visibility',
					13: 'sand',
					14: 'C',
					15: 'D',
					16: 'B',
					17: 'C',
					18: 'Memory',
					19: 'psychological',
					20: 'semantic memory',
					21: ['episodic memory', 'event memory'],
					22: 'algebra',
					23: 'vocabulary',
					24: 'E',
					25: 'B',
					26: 'A',
					27: 'v',
					28: 'v',
					29: 'x',
					30: 'iii',
					31: 'i',
					32: 'vii',
					33: 'viii',
					34: 'C',
					35: 'B',
					36: 'E',
					37: 'A',
					38: 'D',
					39: 'C',
					40: 'D',
				}

				// --- INITIALIZATION ---
				function initialize() {
					console.log(`🚀 Initializing application...`)
					startTimer()
					initializeDragAndDrop()
					setupCheckboxLimits()
					setupExampleHeading()
					console.log(`📋 Setting up initial state - switching to part 1`)
					switchToPart(1) // Also calls goToQuestion(1) and updateNavigation

					document.body.addEventListener('input', updateAllIndicators)
					document.body.addEventListener('change', updateAllIndicators)
					deliverButton.addEventListener('click', checkAnswers)
					timerToggleButton.addEventListener('click', toggleTimer)
					timerResetButton.addEventListener('click', resetTimer)

					// Add click listeners to question containers for navigation
					document.querySelectorAll('[data-q-start]').forEach(el => {
						el.addEventListener('click', event => {
							// Stop event propagation to prevent parent container clicks
							event.stopPropagation()

							const qNum = parseInt(el.dataset.qStart, 10)
							const qEnd = parseInt(el.dataset.qEnd, 10)

							console.log(
								`🖱️ Question container clicked - qNum: ${qNum}, qEnd: ${qEnd}, currentQuestion: ${currentQuestion}, element:`,
								el
							)

							// Handle cases where qNum is NaN
							if (isNaN(qNum)) {
								console.log(
									`ℹ️ Container without valid question number, ignoring navigation`
								)
								return
							}

							// Only navigate if this is a single question (qStart === qEnd) or if we're clicking on a specific question within a group
							if (qNum === qEnd || el.classList.contains('tf-question')) {
								if (currentQuestion !== qNum) {
									console.log(
										`🚀 Navigating from question ${currentQuestion} to question ${qNum}`
									)
									goToQuestion(qNum)
								} else {
									console.log(
										`ℹ️ Already on question ${qNum}, no navigation needed`
									)
								}
							} else {
								console.log(
									`ℹ️ Ignoring click on group container (${qNum}-${qEnd})`
								)
							}
						})
					})

					// Add specific click listeners for individual question elements to prevent parent container interference
					document
						.querySelectorAll('.tf-question, .summary-text')
						.forEach(el => {
							el.addEventListener('click', event => {
								event.stopPropagation()
								const qNum = parseInt(el.dataset.qStart, 10)
								console.log(
									`🎯 Individual question element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, element:`,
									el
								)

								// Handle cases where qNum is NaN (like .summary-text containers)
								if (isNaN(qNum)) {
									console.log(
										`ℹ️ Container without specific question number, ignoring navigation`
									)
									return
								}

								if (currentQuestion !== qNum) {
									console.log(
										`🚀 Navigating from question ${currentQuestion} to question ${qNum} (individual element)`
									)
									goToQuestion(qNum)
								} else {
									console.log(
										`ℹ️ Already on question ${qNum}, no navigation needed (individual element)`
									)
								}
							})
						})

					// Add specific click listeners for individual input elements in questions 33-36
					document
						.querySelectorAll('.answer-input[id^="q3"]')
						.forEach(input => {
							input.addEventListener('click', event => {
								event.stopPropagation()
								const qNum = parseInt(input.id.replace('q', ''), 10)
								console.log(
									`📝 Input element clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, input:`,
									input
								)

								if (currentQuestion !== qNum) {
									console.log(
										`🚀 Navigating from question ${currentQuestion} to question ${qNum} (input element)`
									)
									goToQuestion(qNum)
								} else {
									console.log(
										`ℹ️ Already on question ${qNum}, no navigation needed (input element)`
									)
								}
							})
						})

					// Add click listeners for the paragraph elements containing questions 33-36
					document.querySelectorAll('.summary-text p').forEach(p => {
						p.addEventListener('click', event => {
							event.stopPropagation()
							// Extract question number from the paragraph text (e.g., "33" from "<strong>33</strong>")
							const strongElement = p.querySelector('strong')
							if (strongElement) {
								const qNum = parseInt(strongElement.textContent, 10)
								console.log(
									`📄 Summary paragraph clicked - qNum: ${qNum}, currentQuestion: ${currentQuestion}, paragraph:`,
									p
								)

								if (!isNaN(qNum) && currentQuestion !== qNum) {
									console.log(
										`🚀 Navigating from question ${currentQuestion} to question ${qNum} (summary paragraph)`
									)
									goToQuestion(qNum)
								} else if (!isNaN(qNum)) {
									console.log(
										`ℹ️ Already on question ${qNum}, no navigation needed (summary paragraph)`
									)
								}
							}
						})
					})

					resizer.addEventListener('mousedown', initResize, false)
					initializeContextMenu()
				}

				// --- CORE TEST LOGIC ---

				function checkAnswers() {
					// Disable all inputs to prevent changes
					const allInputs = document.querySelectorAll('input, select, textarea')
					allInputs.forEach(input => {
						input.disabled = true
					})

					// Disable all drag and drop functionality
					document.querySelectorAll('.drag-item').forEach(item => {
						item.setAttribute('draggable', 'false')
						item.style.cursor = 'not-allowed'
						item.style.pointerEvents = 'none'
					})

					document.querySelectorAll('.drop-zone').forEach(zone => {
						zone.style.pointerEvents = 'none'
						zone.classList.add('disabled')
					})

					// Disable submit button
					deliverButton.disabled = true
					deliverButton.style.cursor = 'not-allowed'

					clearInterval(timerInterval)
					let score = 0
					const totalQuestions = 40
					const resultsDetailsContainer =
						document.getElementById('results-details')
					resultsDetailsContainer.innerHTML = ''

					document
						.querySelectorAll('.correct, .incorrect, .correct-answer-highlight')
						.forEach(el => {
							el.classList.remove(
								'correct',
								'incorrect',
								'correct-answer-highlight'
							)
						})
					document
						.querySelectorAll('.correct-answer-display')
						.forEach(el => el.remove())

					for (let i = 1; i <= totalQuestions; i++) {
						const questionKey = String(i)
						const correctAnswer = correctAnswers[questionKey]
						let userAnswer = ''
						let isCorrect = false

						let userAnswerDisplay = 'Not Answered'
						const correctAnswerText = Array.isArray(correctAnswer)
							? correctAnswer.join(' / ')
							: correctAnswer

						const textInput = document.getElementById(`q${i}`)
						const radioGroup = document.querySelectorAll(
							`input[name="q${i}"][type="radio"]`
						)

						// Handle Text and Select Inputs
						if (
							textInput &&
							(textInput.tagName === 'INPUT' || textInput.tagName === 'SELECT')
						) {
							const element =
								textInput.closest('.matching-form-row') || textInput
							userAnswer = textInput.value.trim()
							userAnswerDisplay = userAnswer || 'Not Answered'

							if (textInput.tagName === 'SELECT') {
								isCorrect = userAnswer === correctAnswer
							} else {
								isCorrect = Array.isArray(correctAnswer)
									? correctAnswer.some(
											ans => userAnswer.toLowerCase() === ans.toLowerCase()
									  )
									: userAnswer.toLowerCase() === correctAnswer.toLowerCase()
							}

							if (isCorrect) {
								score++
								element.classList.add('correct')
							} else {
								element.classList.add('incorrect')
								const correctAnswerSpan = document.createElement('span')
								correctAnswerSpan.className = 'correct-answer-display'
								correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswerText}</span>`
								textInput.parentNode.insertBefore(
									correctAnswerSpan,
									textInput.nextSibling
								)
							}
						}
						// Handle drag and drop questions (27-33)
						else if (i >= 27 && i <= 33) {
							console.log(`🔍 Checking drag-and-drop question ${i}`)
							const dropZone = document.querySelector(
								`.drop-zone[data-q-start="${i}"]`
							)
							const droppedItem = dropZone
								? dropZone.querySelector('.drag-item')
								: null

							console.log(`📍 Drop zone for question ${i}:`, dropZone)
							console.log(`📍 Dropped item for question ${i}:`, droppedItem)
							console.log(`📍 Correct answer for question ${i}:`, correctAnswer)

							if (droppedItem) {
								userAnswer = droppedItem.dataset.value
								userAnswerDisplay = userAnswer
								isCorrect = userAnswer === correctAnswer

								console.log(
									`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`
								)

								// Mark the drop zone as correct or incorrect
								dropZone.classList.add(isCorrect ? 'correct' : 'incorrect')

								if (isCorrect) {
									score++
									console.log(`🎉 Question ${i} is correct! Score: ${score}`)
								} else {
									console.log(
										`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`
									)
								}

								// Show correct answer if wrong
								if (!isCorrect && correctAnswer) {
									const correctAnswerSpan = document.createElement('span')
									correctAnswerSpan.className = 'correct-answer-display'
									correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`
									dropZone.appendChild(correctAnswerSpan)
								}
							} else {
								// No answer provided - mark as incorrect
								console.log(`⚠️ No answer provided for question ${i}`)
								if (dropZone) {
									dropZone.classList.add('incorrect')
								}
								if (correctAnswer) {
									const correctAnswerSpan = document.createElement('span')
									correctAnswerSpan.className = 'correct-answer-display'
									correctAnswerSpan.innerHTML = `&nbsp;➜&nbsp;<span class="correct-answer-highlight">${correctAnswer}</span>`
									dropZone.appendChild(correctAnswerSpan)
								}
							}
						}
						// Handle Radio Button Inputs (T/F, MCQs)
						else if (radioGroup.length > 0) {
							const questionContainer =
								radioGroup[0]?.closest('.tf-question') ||
								radioGroup[0]?.closest('.multi-choice-question')
							const checkedRadio = document.querySelector(
								`input[name="q${i}"]:checked`
							)

							if (checkedRadio) {
								userAnswer = checkedRadio.value
								userAnswerDisplay = userAnswer
								isCorrect = userAnswer === correctAnswer

								const userLabel = checkedRadio.closest(
									'.tf-option, .multi-choice-option'
								)
								if (userLabel) {
									userLabel.classList.add(isCorrect ? 'correct' : 'incorrect')
								}

								// Handle table radio buttons
								if (checkedRadio.classList.contains('table-radio')) {
									const tableCell = checkedRadio.closest('td')
									if (tableCell) {
										tableCell.classList.add(isCorrect ? 'correct' : 'incorrect')
									}
								}
							}

							if (isCorrect) {
								score++
							} else {
								if (questionContainer) {
									const correctOptionEl = questionContainer.querySelector(
										`input[value="${correctAnswerText}"]`
									)
									if (correctOptionEl) {
										const correctLabel = correctOptionEl.closest(
											'.tf-option, .multi-choice-option'
										)
										if (correctLabel) {
											correctLabel.classList.add('correct-answer-highlight')
										}
									}
								}
							}
						}
						// Handle clickable cells for questions 21-26 and 34-38
						else if ((i >= 21 && i <= 26) || (i >= 34 && i <= 38)) {
							console.log(`🔍 Checking clickable cell question ${i}`)
							const selectedCell = document.querySelector(
								`.clickable-cell[data-question="${i}"][data-selected="true"]`
							)
							console.log(`📍 Selected cell for question ${i}:`, selectedCell)
							console.log(`📍 Correct answer for question ${i}:`, correctAnswer)

							if (selectedCell) {
								userAnswer = selectedCell.dataset.answer
								userAnswerDisplay = userAnswer
								isCorrect = userAnswer === correctAnswer

								console.log(
									`✅ User answer for question ${i}: "${userAnswer}", Correct: "${correctAnswer}", IsCorrect: ${isCorrect}`
								)

								selectedCell.classList.add(isCorrect ? 'correct' : 'incorrect')

								if (isCorrect) {
									score++
									console.log(`🎉 Question ${i} is correct! Score: ${score}`)
								} else {
									console.log(
										`❌ Question ${i} is incorrect. Expected: "${correctAnswer}", Got: "${userAnswer}"`
									)
								}
							} else {
								console.log(`⚠️ No answer provided for question ${i}`)
								userAnswerDisplay = 'Not Answered'
							}

							// Handle highlighting correct answers for incorrect responses
							if (!isCorrect) {
								const correctCell = document.querySelector(
									`.clickable-cell[data-question="${i}"][data-value="${correctAnswerText}"]`
								)
								if (correctCell) {
									correctCell.classList.add('correct-answer-highlight')
									console.log(
										`✅ Highlighted correct answer for question ${i}:`,
										correctCell
									)
								} else {
									console.log(
										`⚠️ Could not find correct cell for question ${i} with value "${correctAnswerText}"`
									)
								}
							}
						}
						// Handle Checkbox Inputs (Multiple choice questions like 24-26)
						else if (i >= 24 && i <= 26) {
							const checkedCheckboxes = document.querySelectorAll(
								`input[name="q24-26"]:checked`
							)
							const userAnswers = Array.from(checkedCheckboxes)
								.map(cb => cb.value)
								.sort()
							const correctAnswersArr = Array.isArray(correctAnswer)
								? correctAnswer
								: [correctAnswer]
							const correctAnswersSorted = correctAnswersArr.sort()

							userAnswerDisplay =
								userAnswers.length > 0 ? userAnswers.join(', ') : 'Not Answered'
							isCorrect =
								userAnswers.length === correctAnswersSorted.length &&
								userAnswers.every(
									(ans, index) => ans === correctAnswersSorted[index]
								)

							if (isCorrect) {
								score++
								checkedCheckboxes.forEach(cb => {
									cb.closest('.multi-choice-option')?.classList.add('correct')
								})
							} else {
								checkedCheckboxes.forEach(cb => {
									cb.closest('.multi-choice-option')?.classList.add('incorrect')
								})
								// Highlight correct answers
								correctAnswersArr.forEach(ansValue => {
									const correctCheckbox = document.querySelector(
										`input[name="q24-26"][value="${ansValue}"]`
									)
									if (correctCheckbox) {
										correctCheckbox
											.closest('.multi-choice-option')
											?.classList.add('correct-answer-highlight')
									}
								})
							}
						}

						// For showing results in the modal
						const resultRow = `
                    <div class="result-row ${isCorrect ? '' : 'incorrect'}">
                        <span class="q-num">${i}</span>
                        <span class="user-ans">${userAnswerDisplay}</span>
                        <span class="correct-ans">${correctAnswerText}</span>
                    </div>`
						resultsDetailsContainer.innerHTML += resultRow

						// Update nav button color
						const navButton = document.querySelector(
							`.subQuestion[onclick="goToQuestion(${i})"]`
						)
						if (navButton) {
							navButton.classList.remove('answered', 'active')
							navButton.classList.add(isCorrect ? 'correct' : 'incorrect')
						}
					}

					document.getElementById('results-score').textContent = score
					document.getElementById('results-band').textContent =
						calculateBandScore(score)
					document.getElementById('results-modal').classList.remove('hidden')

					// Change button to "My Result" with green styling
					deliverButton.innerHTML = `<span>My Result</span>`
					deliverButton.style.backgroundColor = '#4CAF50'
					deliverButton.style.color = 'white'
					deliverButton.style.borderColor = '#4CAF50'
					deliverButton.disabled = false
					deliverButton.style.cursor = 'pointer'
					deliverButton.removeEventListener('click', checkAnswers)
					deliverButton.addEventListener('click', showResultsModal)

					// Highlight correct answers in the passage
					highlightCorrectAnswersInPassage()
				}

				function calculateBandScore(score) {
					if (score >= 39) return '9.0'
					const mapping = {
						40: 9.0,
						39: 9.0,
						38: 8.5,
						37: 8.5,
						36: 8.0,
						35: 8.0,
						34: 7.5,
						33: 7.5,
						32: 7.0,
						31: 7.0,
						30: 7.0,
						29: 6.5,
						28: 6.5,
						27: 6.5,
						26: 6.0,
						25: 6.0,
						24: 6.0,
						23: 5.5,
						22: 5.5,
						21: 5.5,
						20: 5.5,
						19: 5.0,
						18: 5.0,
						17: 5.0,
						16: 5.0,
						15: 5.0,
						14: 4.5,
						13: 4.5,
						12: 4.0,
						11: 4.0,
						10: 4.0,
						9: 3.5,
						8: 3.5,
						7: 3.0,
						6: 3.0,
						5: 2.5,
						4: 2.5,
					}
					if (score <= 0) return 0.0
					if (score === 1) return 1.0
					if (score <= 3) return 2.0
					if (score <= 5) return 2.5
					return mapping[score] || 0.0
				}

				function highlightCorrectAnswersInPassage() {
					// Define the text passages and their corresponding question numbers for Part 1
					const part1Highlights = [
						{
							question: 1,
							text: "China's highest government body published their conclusions from the second research session on continental climate change over a period of twelve months",
							answer: 'YES',
						},
						{
							question: 2,
							text: 'the Chinese prime minister was very keen to raise climate change as an important issue at the upcoming G8 summit in Hokkaido, Japan',
							answer: 'NO',
						},
						{
							question: 3,
							text: 'The Chinese Government must compensate the European Union for loss of climate change',
							answer: 'NOT GIVEN',
						},
						{
							question: 4,
							text: 'A non-governmental organization (Climate Group) newspaper report presents a slightly different picture',
							answer: 'YES',
						},
						{
							question: 5,
							text: 'Solar energy has increased the amount of energy',
							answer: 'NOT GIVEN',
						},
						{
							question: 6,
							text: 'Both wind and solar power are so successful, but their origins are very different',
							answer: 'YES',
						},
						{
							question: 7,
							text: 'In China, the solar market has been a small business, because the cells are so expensive',
							answer: 'YES',
						},
						{
							question: 8,
							text: 'China now has the highest level of carbon dioxide emissions in the world',
							answer: 'carbon dioxide',
						},
						{
							question: 9,
							text: 'A non-governmental organization (Climate Group) newspaper report presents a slightly different picture',
							answer: 'NGO',
						},
						{
							question: 10,
							text: 'the National Renewable Energy Law in 2006. This has set hard targets',
							answer: 'Renewable Energy Law',
						},
						{
							question: 11,
							text: 'renewable energy sources, such as biomass, solar and wind',
							answer: 'solar, wind, biomass',
						},
						{
							question: 12,
							text: 'Wind power successfully shows that with central government aid China is ready for new policies, subsidies and advanced technology',
							answer: 'technology',
						},
						{
							question: 13,
							text: 'the role of the Climate Group is important in developing domestic markets',
							answer: 'The Climate Group',
						},
					]

					// Define the text passages and their corresponding question numbers for Part 2
					const part2Highlights = [
						{
							question: 14,
							text: 'When a rocket made by Space X in Hawthorne, California, reached an orbit of 500 kilometres from the Earth',
							answer: 'Space X',
						},
						{
							question: 15,
							text: 'Virgin Galactic started a business with the US National Oceanic and Atmospheric Administration which will be accepted by US scientists as a way of researching climate change using a spacecraft',
							answer: 'US scientists',
						},
						{
							question: 16,
							text: "It displayed slick promotional videos, and models of the 'Nearly Ready' spacecraft in orbit",
							answer: 'Nearly Ready',
						},
						{
							question: 17,
							text: 'there need to be enforceable regulations in place to guarantee the safety of a civilian spacecraft',
							answer: 'safety',
						},
						{
							question: 18,
							text: "One way companies are planning to transport tourists into space is with a 'mother ship', an aircraft which carries a rocket",
							answer: 'mother ship',
						},
						{
							question: 19,
							text: 'lawyers cannot agree on whether it is a plane or a rocket',
							answer: 'plane',
						},
						{
							question: 20,
							text: "The other aspects of the UN's 1967 treaty for outer space exploration may be discussed again if civilian space flight turns out to be successful",
							answer: "UN's 1967 treaty",
						},
						{
							question: 21,
							text: 'they have already had the experience of dealing with a tragedy. Unfortunately, three engineers were killed',
							answer: 'C',
						},
						{
							question: 22,
							text: 'other critical safety factors are with depressurization risks, passengers close to the engine',
							answer: 'A',
						},
						{
							question: 23,
							text: 'the VSH will equip an ejector seat for all tourists and staff',
							answer: 'F',
						},
						{
							question: 24,
							text: "the civilian space flight regulation must not 'stifle' the developing technologies with inconvenient rules",
							answer: 'B',
						},
						{
							question: 25,
							text: 'will leave a commercial space flight in the dangerous activity categories in terms of the insurance',
							answer: 'D',
						},
						{
							question: 26,
							text: 'Critics who are developing safety standards also insist',
							answer: 'E',
						},
					]

					// Define the text passages and their corresponding question numbers for Part 3
					const part3Highlights = [
						{
							question: 27,
							text: 'It is tempting to think that the conservation of coral reefs and rainforests is a separate issue from traffic and air pollution. But it is not',
							answer: 'vii',
						},
						{
							question: 28,
							text: "The United Nation's Climate Change Panel has estimated that the global average temperature rise expected by the year 2100 could be as much as 6°C",
							answer: 'iv',
						},
						{
							question: 29,
							text: "This was actually invented in the late nineteenth century, but because the world's motor industry put its effort into developing the combustion engine",
							answer: 'vi',
						},
						{
							question: 30,
							text: 'Hydrogen goes into the fuel tank, producing electricity. The only emission from the exhaust pipe is water. The fuel-cell is, in some ways similar to a battery',
							answer: 'v',
						},
						{
							question: 31,
							text: 'One source of hydrogen is water. But to exploit the abundant resource, electricity is needed… Another source of hydrogen is, however, available',
							answer: 'viii',
						},
						{
							question: 32,
							text: 'Even now, fuel-cell buses are operating in the US, while in Germany a courier company is planning to take delivery of fuel-cell-powered vans',
							answer: 'iii',
						},
						{
							question: 33,
							text: "the world's motor industry put its effort into developing the combustion engine, it was never refined for mass production",
							answer: 'combustion engine',
						},
						{
							question: 34,
							text: 'Ford engineers expect to be able to produce a virtually silent vehicle in the future',
							answer: 'silent',
						},
						{
							question: 35,
							text: 'The fuel-cell is, in some ways similar to a battery, but unlike a battery, it does not run down',
							answer: 'battery',
						},
						{
							question: 36,
							text: 'Fuel-cells can be made in a huge range of size, small enough for portable computers or large enough for power stations',
							answer: 'portable computers',
						},
						{
							question: 37,
							text: 'if the electricity is produced by a coal-fired power station or other fossil fuel, then the overall carbon reduction benefit of the fuel-cell disappears',
							answer: 'FALSE',
						},
						{
							question: 38,
							text: "Oil companies, such as Norway's Statoil, are experimenting with storing carbon dioxide below ground in oil and gas wells",
							answer: 'NOT GIVEN',
						},
						{
							question: 39,
							text: 'Even now, fuel-cell buses are operating in the US, while in Germany a courier company is planning to take delivery of fuel-cell-powered vans',
							answer: 'TRUE',
						},
						{
							question: 40,
							text: 'This technology could have a major impact in slowing down climate change, but further investment is needed',
							answer: 'TRUE',
						},
					]

					// Function to apply highlights to a passage
					function applyHighlights(passageElement, highlights) {
						if (!passageElement) return

						// Clear any existing highlights
						passageElement.querySelectorAll('.answer-highlight').forEach(el => {
							const parent = el.parentNode
							parent.replaceChild(document.createTextNode(el.textContent), el)
							parent.normalize()
						})

						// Add highlights for each answer
						highlights.forEach(item => {
							const paragraphs = passageElement.querySelectorAll('p')
							paragraphs.forEach(paragraph => {
								const text = paragraph.textContent
								if (text.includes(item.text)) {
									const highlightedText = text.replace(
										item.text,
										`<span class="answer-highlight" data-question="${item.question}" style="
                                    background-color: #ffeb3b;
                                    padding: 2px 4px;
                                    border-radius: 3px;
                                    font-weight: bold;
                                    position: relative;
                                ">${item.text}<span style="
                                    position: absolute;
                                    top: -8px;
                                    right: -8px;
                                    background-color: #2196f3;
                                    color: white;
                                    border-radius: 50%;
                                    width: 20px;
                                    height: 20px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 12px;
                                    font-weight: bold;
                                ">${item.question}</span></span>`
									)
									paragraph.innerHTML = highlightedText
								}
							})
						})
					}

					// Apply highlights to Part 1 (The Green Revolution in China)
					const passageText1 = document.getElementById('passage-text-1')
					applyHighlights(passageText1, part1Highlights)

					// Apply highlights to Part 2 (Reclaiming the Night)
					const passageText2 = document.getElementById('passage-text-2')
					applyHighlights(passageText2, part2Highlights)

					// Apply highlights to Part 3 (Paper or Computer?)
					const passageText3 = document.getElementById('passage-text-3')
					applyHighlights(passageText3, part3Highlights)
				}

				function getUserAnswer(qNum) {
					const textInput = document.getElementById(`q${qNum}`)
					const radioInput = document.querySelector(
						`input[name="q${qNum}"]:checked`
					)
					const dropZone = document.querySelector(
						`.drop-zone[data-q-start="${qNum}"]`
					)

					if (textInput) {
						// Handles <input type="text"> and <select>
						return { value: textInput.value, text: textInput.value || 'N/A' }
					}
					if (radioInput) {
						return { value: radioInput.value, text: radioInput.value }
					}
					if (dropZone) {
						const droppedItem = dropZone.querySelector('.drag-item')
						return {
							value: droppedItem ? droppedItem.dataset.value : null,
							text: droppedItem ? droppedItem.textContent.trim() : 'N/A',
						}
					}
					// Handle clickable cells for questions 23-26
					if (qNum >= 23 && qNum <= 26) {
						const selectedCell = document.querySelector(
							`.clickable-cell[data-question="${qNum}"][data-selected="true"]`
						)
						if (selectedCell) {
							return {
								value: selectedCell.dataset.answer,
								text: selectedCell.dataset.answer,
							}
						}
					}
					return { value: null, text: 'N/A' }
				}

				function displayCorrectAnswer(qNum, correctAnswer) {
					// Handle multi-choice group questions (e.g., 24-26, 38-40)
					if ((qNum >= 24 && qNum <= 26) || (qNum >= 38 && qNum <= 40)) {
						const groupName = qNum >= 24 && qNum <= 26 ? 'q24-26' : 'q38-40'
						const correctAnswersArr = Array.isArray(correctAnswer)
							? correctAnswer
							: [correctAnswer]
						correctAnswersArr.forEach(ansValue => {
							const correctInput = document.querySelector(
								`input[name="${groupName}"][value="${ansValue}"]`
							)
							correctInput
								?.closest('.multi-choice-option')
								?.classList.add('correct-answer-highlight')
						})
						return
					}

					// Handle radio button questions by highlighting the correct label
					const correctRadioInput = document.querySelector(
						`input[name="q${qNum}"][value="${correctAnswer}"]`
					)
					if (correctRadioInput) {
						const parentOption = correctRadioInput.closest(
							'.tf-option, .multi-choice-option'
						)
						if (parentOption) {
							parentOption.classList.add('correct-answer-highlight')
							return
						}
					}

					// Handle text inputs, select dropdowns, and others by showing the answer next to them
					const inputEl = document.getElementById(`q${qNum}`)
					if (inputEl) {
						const displaySpan = document.createElement('span')
						displaySpan.className = 'correct-answer-display'
						displaySpan.textContent = ` ✓ ${correctAnswer}`
						inputEl.insertAdjacentElement('afterend', displaySpan)
						return // Done
					}

					// Fallback for questions identified by a container (e.g., some T/F/NG questions)
					const element = findQuestionElement(qNum)
					if (element) {
						const displaySpan = document.createElement('span')
						displaySpan.className = 'correct-answer-display'
						displaySpan.textContent = ` ✓ ${correctAnswer}`
						const itemContainer = element.querySelector('.tf-question-text')
						if (itemContainer) {
							itemContainer.appendChild(displaySpan)
						} else {
							element.appendChild(displaySpan)
						}
					}
				}

				function findQuestionElement(qNum) {
					return document.querySelector(`[data-q-start="${qNum}"]`)
				}

				function addResultToModal(qNum, userAnswer, correctAnswer, isCorrect) {
					const resultsDetails = document.getElementById('results-details')
					const row = document.createElement('div')
					row.className = 'result-row'
					if (!isCorrect) {
						row.classList.add('incorrect')
					}
					row.innerHTML = `
                <span class="q-num">${qNum}</span>
                <span class="user-ans">${userAnswer}</span>
                <span class="correct-ans">${correctAnswer}</span>
            `
					resultsDetails.appendChild(row)
				}

				function showResultsModal() {
					document.getElementById('results-modal').classList.remove('hidden')
				}

				window.closeResultsModal = function () {
					document.getElementById('results-modal').classList.add('hidden')
				}

				function disableInputs() {
					deliverButton.innerHTML = `<span>Checked! View Results.</span>`
					deliverButton.removeEventListener('click', checkAnswers)
					deliverButton.onclick = showResultsModal

					document.querySelectorAll('input, select').forEach(el => {
						el.disabled = true
						if (el.matches('input[type=radio], input[type=checkbox]')) {
							el.style.cursor = 'not-allowed'
							el.parentElement.style.cursor = 'not-allowed'
						}
					})
					document.querySelectorAll('.drag-item').forEach(el => {
						el.setAttribute('draggable', 'false')
						el.style.cursor = 'default'
					})
					document.querySelectorAll('.drop-zone').forEach(el => {
						el.classList.add('disabled')
					})
				}

				function checkValue(userValue, correctValue) {
					if (userValue === null || userValue === undefined) return false
					const formattedUserValue = userValue.trim().toLowerCase()
					if (Array.isArray(correctValue)) {
						return correctValue
							.map(v => v.toLowerCase())
							.includes(formattedUserValue)
					} else {
						return formattedUserValue === String(correctValue).toLowerCase()
					}
				}

				function markQuestion(qNum, isCorrect) {
					const subQuestionBtn = document.querySelector(
						`.subQuestion[onclick="goToQuestion(${qNum})"]`
					)
					subQuestionBtn?.classList.add(isCorrect ? 'correct' : 'incorrect')

					const elementsToMark = [
						document.querySelector(`.tf-question[data-q-start="${qNum}"]`),
						document.querySelector(
							`.multi-choice-question[data-q-start="${qNum}"]`
						),
						document.querySelector(
							`.matching-question-item[data-q-start="${qNum}"]`
						),
						document.querySelector(`.drop-zone[data-q-start="${qNum}"]`),
						document.getElementById(`q${qNum}`),
						document
							.querySelector(`input[name="q${qNum}"]:checked`)
							?.closest('.tf-option'),
						document
							.querySelector(`input[name="q${qNum}"]:checked`)
							?.closest('.multi-choice-option'),
					]

					elementsToMark.forEach(el => {
						if (el) el.classList.add(isCorrect ? 'correct' : 'incorrect')
					})

					if (qNum === 14 || qNum === 15) {
						const multiChoiceContainer = document.querySelector(
							'.multi-choice-question[data-q-start="14"]'
						)
						if (multiChoiceContainer)
							multiChoiceContainer.classList.add(
								isCorrect ? 'correct' : 'incorrect'
							)
					} else if (qNum >= 1 && qNum <= 5) {
						const pMatchInput = document.getElementById(`q${qNum}`)
						if (pMatchInput)
							pMatchInput.classList.add(isCorrect ? 'correct' : 'incorrect')
					} else if (qNum >= 38 && qNum <= 40) {
						// For this group, individual options are marked, not the container.
					}
				}

				function switchToPart(partNumber) {
					console.log(
						`🔀 switchToPart called with partNumber: ${partNumber}, currentPassage: ${currentPassage}`
					)

					currentPassage = partNumber

					// Hide all passages and questions
					document
						.querySelectorAll('.reading-passage, .question-set, .part-header')
						.forEach(el => {
							el.classList.add('hidden')
						})

					// Show the correct passage, questions, and header
					document
						.getElementById(`passage-text-${partNumber}`)
						.classList.remove('hidden')
					document
						.getElementById(`questions-${partNumber}`)
						.classList.remove('hidden')
					document
						.getElementById(`part-header-${partNumber}`)
						.classList.remove('hidden')

					// Update bottom navigation 'selected' state
					document
						.querySelectorAll('.footer__questionWrapper___1tZ46')
						.forEach((wrapper, index) => {
							wrapper.classList.toggle('selected', index + 1 === partNumber)
						})

					// Show/hide explanation buttons based on part
					const explanationButton = document.getElementById(
						'show-explanation-btn'
					)
					const explanationButtonPart3 = document.getElementById(
						'show-explanation-btn-part3'
					)

					if (explanationButton) {
						if (partNumber === 2) {
							explanationButton.style.display = 'block'
						} else {
							explanationButton.style.display = 'none'
							// Hide explanation section when switching away from part 2
							const explanationSection =
								document.getElementById('part-2-explanation')
							if (explanationSection) {
								explanationSection.classList.add('hidden')
								explanationButton.textContent = 'Show Explanation'
								explanationButton.style.backgroundColor = '#4a90e2'
							}
						}
					}

					if (explanationButtonPart3) {
						if (partNumber === 3) {
							explanationButtonPart3.style.display = 'block'
						} else {
							explanationButtonPart3.style.display = 'none'
							// Hide explanation section when switching away from part 3
							const explanationSection =
								document.getElementById('part-3-explanation')
							if (explanationSection) {
								explanationSection.classList.add('hidden')
								explanationButtonPart3.textContent = 'Show Explanation'
								explanationButtonPart3.style.backgroundColor = '#4a90e2'
							}
						}
					}

					console.log(
						`✅ switchToPart completed - switched to part ${partNumber}`
					)

					// Only go to first question when switching parts, not when staying in same part
					// This allows goToQuestion to work properly for specific question navigation
					// const firstQuestionOfPart = {1: 1, 2: 14, 3: 27}[partNumber];
					// goToQuestion(firstQuestionOfPart);
				}

				function goToQuestion(questionNumber) {
					console.log(
						`🎯 goToQuestion called with questionNumber: ${questionNumber}, currentQuestion: ${currentQuestion}, currentPassage: ${currentPassage}`
					)

					currentQuestion = questionNumber

					let passageNumber = 1
					if (questionNumber >= 14 && questionNumber <= 26) passageNumber = 2
					else if (questionNumber >= 27) passageNumber = 3

					console.log(
						`📍 Calculated passageNumber: ${passageNumber} for question ${questionNumber}`
					)

					if (currentPassage !== passageNumber) {
						console.log(
							`🔄 Switching from part ${currentPassage} to part ${passageNumber} for question ${questionNumber}`
						)
						switchToPart(passageNumber)
						return
					}

					console.log(
						`✅ Staying in same part (${currentPassage}) for question ${questionNumber}`
					)

					if (activeQuestionElement) {
						activeQuestionElement.classList.remove(
							'active-question',
							'active-input'
						)
					}

					// First, try to find the specific input element for questions 33-36
					let targetEl = document.getElementById(`q${questionNumber}`)
					if (targetEl) {
						activeQuestionElement = targetEl
						console.log(`✅ Found specific input element:`, targetEl)
						targetEl.classList.add('active-input')
						scrollIntoViewIfNeeded(targetEl)
					} else {
						// Fall back to looking for question containers
						targetEl = document.querySelector(
							`[data-q-start="${questionNumber}"]`
						)
						console.log(
							`🔍 Looking for target element with data-q-start="${questionNumber}":`,
							targetEl
						)

						if (targetEl) {
							activeQuestionElement = targetEl
							console.log(`✅ Found target element:`, targetEl)

							if (
								targetEl.matches('input[type="text"]') ||
								targetEl.matches('select')
							) {
								targetEl.classList.add('active-input')
								console.log(
									`📝 Added active-input class to input/select element`
								)
							} else {
								targetEl.classList.add('active-question')
								console.log(
									`📋 Added active-question class to question element`
								)
							}
							scrollIntoViewIfNeeded(targetEl)
						} else {
							console.log(
								`⚠️ Target element not found, looking for paragraph matching question`
							)
							const pMatch = document.querySelector(
								`.paragraph-matching-question select[id="q${questionNumber}"]`
							)
							if (pMatch) {
								activeQuestionElement = pMatch
								pMatch.classList.add('active-input')
								scrollIntoViewIfNeeded(pMatch)
								console.log(`✅ Found paragraph matching question:`, pMatch)
							} else {
								console.log(
									`❌ No target element found for question ${questionNumber}`
								)
							}
						}
					}

					updateNavigation()
					console.log(
						`✅ goToQuestion completed for question ${questionNumber}`
					)
				}

				// --- UI & NAVIGATION ---

				function updateNavigation() {
					console.log(
						`🔄 updateNavigation called for currentQuestion: ${currentQuestion}`
					)

					const navButtons = document.querySelectorAll('.subQuestion')
					navButtons.forEach(btn => btn.classList.remove('active'))
					const activeNav = document.querySelector(
						`.subQuestion[onclick="goToQuestion(${currentQuestion})"]`
					)
					if (activeNav) {
						activeNav.classList.add('active')
						console.log(`✅ Updated navigation - active nav button:`, activeNav)
					} else {
						console.log(
							`⚠️ No active navigation button found for question ${currentQuestion}`
						)
					}

					const inputs = document.querySelectorAll(
						'.answer-input, .drop-zone.filled, .summary-drop-zone.filled'
					)
					inputs.forEach(input => input.classList.remove('active-input'))

					const activeInput = document.getElementById(`q${currentQuestion}`)
					if (activeInput) {
						activeInput.classList.add('active-input')
						if (typeof activeInput.focus === 'function') {
							activeInput.focus()
						}
						console.log(`✅ Focused on input element:`, activeInput)
					} else {
						console.log(
							`⚠️ No direct input found for question ${currentQuestion}, looking in question block`
						)
						const activeQuestionBlock = document.querySelector(
							`[data-q-start="${currentQuestion}"]`
						)
						if (activeQuestionBlock) {
							const firstInput =
								activeQuestionBlock.querySelector('input, select')
							if (firstInput) {
								firstInput.classList.add('active-input')
								if (typeof firstInput.focus === 'function') {
									firstInput.focus()
								}
								console.log(
									`✅ Focused on input in question block:`,
									firstInput
								)
							} else {
								console.log(
									`⚠️ No input found in question block for question ${currentQuestion}`
								)
							}
						} else {
							console.log(
								`❌ No question block found for question ${currentQuestion}`
							)
						}
					}

					console.log(`✅ updateNavigation completed`)
				}

				function selectDragItem(item) {
					if (selectedDragItem) {
						selectedDragItem.classList.remove('selected')
					}
					selectedDragItem = item
					if (selectedDragItem) {
						selectedDragItem.classList.add('selected')
					}
				}

				window.nextQuestion = () =>
					currentQuestion < 40 && goToQuestion(currentQuestion + 1)
				window.previousQuestion = () =>
					currentQuestion > 1 && goToQuestion(currentQuestion - 1)

				function updateAllIndicators() {
					updateAttemptedCount(1, 1, 13)
					updateAttemptedCount(2, 14, 26)
					updateAttemptedCount(3, 27, 40)
					updateAnsweredNav()
				}

				function updateAnsweredNav() {
					const navButtons = document.querySelectorAll('.subQuestion')
					navButtons.forEach(btn => {
						const qNum = parseInt(btn.textContent, 10)
						if (isQuestionAnswered(qNum)) {
							btn.classList.add('answered')
						} else {
							btn.classList.remove('answered')
						}
					})
				}

				function isQuestionAnswered(qNum) {
					const textInput = document.getElementById(`q${qNum}`)
					if (
						textInput &&
						(textInput.value.trim() !== '' ||
							(textInput.classList.contains('drop-zone') &&
								textInput.children.length > 0))
					) {
						return true
					}
					const radio = document.querySelector(`input[name="q${qNum}"]:checked`)
					if (radio) {
						return true
					}
					const checkbox = document.querySelector(
						`input[name="q${qNum}"]:checked`
					)
					if (checkbox) {
						return true
					}
					// Handle clickable cells for questions 23-26
					if (qNum >= 23 && qNum <= 26) {
						const selectedCell = document.querySelector(
							`.clickable-cell[data-question="${qNum}"][data-selected="true"]`
						)
						if (selectedCell) {
							return true
						}
					}
					return false
				}

				function scrollIntoViewIfNeeded(element) {
					const panel = element.closest('.questions-panel, .passage-panel')
					const panelRect = panel.getBoundingClientRect()
					const elementRect = element.getBoundingClientRect()
					if (
						elementRect.top < panelRect.top ||
						elementRect.bottom > panelRect.bottom
					) {
						element.scrollIntoView({ behavior: 'smooth', block: 'center' })
					}
				}

				// --- DRAG AND DROP ---

				function initializeDragAndDrop() {
					document.querySelectorAll('.drag-item').forEach(item => {
						item.addEventListener('dragstart', handleDragStart)
						item.addEventListener('dragend', handleDragEnd)
						item.addEventListener('click', () => selectDragItem(item))
					})
					document
						.querySelectorAll('.drop-zone, .drag-options-container')
						.forEach(zone => {
							zone.addEventListener('dragover', handleDragOver)
							zone.addEventListener('dragleave', handleDragLeave)
							zone.addEventListener('drop', handleDrop)
						})
				}

				function handleDragStart(e) {
					draggedItem = e.target
					setTimeout(() => e.target.classList.add('dragging'), 0)
				}

				function handleDragEnd(e) {
					e.target.classList.remove('dragging')
					draggedItem = null
				}

				function handleDragOver(e) {
					e.preventDefault()
					const targetZone = e.currentTarget
					if (
						draggedItem &&
						draggedItem.dataset.dndGroup === targetZone.dataset.dndGroup
					) {
						targetZone.classList.add('drag-over')
					}
				}

				function handleDragLeave(e) {
					e.currentTarget.classList.remove('drag-over')
				}

				function handleDrop(e) {
					e.preventDefault()
					const targetZone = e.currentTarget
					targetZone.classList.remove('drag-over')

					if (
						!draggedItem ||
						draggedItem.dataset.dndGroup !== targetZone.dataset.dndGroup
					) {
						return
					}

					const sourceZone = draggedItem.parentElement
					if (sourceZone === targetZone) return // Prevent dropping on itself

					const existingItemInTarget = targetZone.classList.contains(
						'drop-zone'
					)
						? targetZone.querySelector('.drag-item')
						: null

					// First, clear the target drop-zone of any text (like question numbers) before adding the new item.
					if (targetZone.classList.contains('drop-zone')) {
						Array.from(targetZone.childNodes).forEach(node => {
							if (node.nodeType === Node.TEXT_NODE) {
								node.remove()
							}
						})
					}

					// Move the item that was in the target (if any) to the source zone.
					if (existingItemInTarget) {
						sourceZone.appendChild(existingItemInTarget)
					}

					// Finally, move the dragged item to the target zone.
					targetZone.appendChild(draggedItem)
					targetZone.classList.add('filled')

					// After the move, clean up the source zone if it's a drop-zone and is now empty.
					if (
						sourceZone.classList.contains('drop-zone') &&
						!sourceZone.querySelector('.drag-item')
					) {
						sourceZone.classList.remove('filled')
						const qNum = sourceZone.dataset.qStart
						sourceZone.innerText = qNum // Restore the question number
					}

					updateAllIndicators()
				}

				// --- MISC HELPERS ---

				function startTimer() {
					if (timerInterval) clearInterval(timerInterval) // Ensure no multiple intervals
					timerInterval = setInterval(() => {
						timeInSeconds--
						const minutes = Math.floor(timeInSeconds / 60)
						const seconds = timeInSeconds % 60
						timerDisplay.textContent = `${minutes
							.toString()
							.padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`
						if (timeInSeconds <= 0) {
							clearInterval(timerInterval)
							timerDisplay.textContent = "Time's up!"
							// checkAnswers(); // Disabled to prevent modal from opening automatically.
						}
					}, 1000)
					timerToggleButton.innerHTML = pauseIcon
				}

				function pauseTimer() {
					clearInterval(timerInterval)
					timerToggleButton.innerHTML = playIcon
				}

				function toggleTimer() {
					// Check based on the icon currently displayed
					if (timerToggleButton.innerHTML.includes('M6 19h4V5H6v14z')) {
						// Check for pause icon shape
						pauseTimer()
					} else {
						startTimer()
					}
				}

				function resetTimer() {
					timeInSeconds = 3600
					const minutes = Math.floor(timeInSeconds / 60)
					const seconds = timeInSeconds % 60
					timerDisplay.textContent = `${minutes
						.toString()
						.padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`
					startTimer()
					timerToggleButton.innerHTML = pauseIcon
				}

				function setupCheckboxLimits() {
					const checkboxGroups = [{ name: 'q38-40', limit: 3 }]
					checkboxGroups.forEach(group => {
						const checkboxes = document.querySelectorAll(
							`input[name="${group.name}"]`
						)
						checkboxes.forEach(checkbox => {
							checkbox.addEventListener('change', () => {
								const checkedCount = document.querySelectorAll(
									`input[name="${group.name}"]:checked`
								).length
								if (checkedCount > group.limit) checkbox.checked = false
								updateAllIndicators()
							})
						})
					})
				}

				function setupExampleHeading() {
					const exampleBox = document.querySelector('.example-box')
					if (exampleBox) {
						const title = document.createElement('p')
						title.style.fontWeight = 'bold'
						title.textContent = 'List of Statements'
						// exampleBox.insertBefore(title, exampleBox.firstChild);
					}
				}

				function initResize(e) {
					e.preventDefault()
					const startX = e.clientX
					const startWidth = passagePanel.offsetWidth

					const doDrag = e => {
						const newWidth = startWidth + e.clientX - startX
						if (
							newWidth > 200 &&
							document.body.clientWidth - newWidth - resizer.offsetWidth > 200
						) {
							passagePanel.style.flex = `0 0 ${newWidth}px`
						}
					}
					const stopDrag = () => {
						window.removeEventListener('mousemove', doDrag, false)
						window.removeEventListener('mouseup', stopDrag, false)
					}

					window.addEventListener('mousemove', doDrag, false)
					window.addEventListener('mouseup', stopDrag, false)
				}

				// --- CONTEXT MENU (Highlighting) ---

				function initializeContextMenu() {
					const panels = [passagePanel, questionsPanel]
					let targetElementForClear = null

					// This listener simply tracks the last valid text selection in either panel.
					document.addEventListener('selectionchange', () => {
						const selection = window.getSelection()
						if (
							selection &&
							!selection.isCollapsed &&
							selection.toString().trim().length > 0
						) {
							const range = selection.getRangeAt(0)
							if (
								panels.some(panel =>
									panel.contains(range.commonAncestorContainer)
								)
							) {
								selectedRange = range
								targetElementForClear = null // New selection overrides clearing a specific element
							}
						}
					})

					const showContextMenu = e => {
						const target = e.target
						const isClickOnHighlight = target.closest(
							'.highlight, .comment-highlight'
						)
						const isSelectionActive =
							selectedRange && selectedRange.toString().trim().length > 0

						let showMenu = false

						if (isClickOnHighlight) {
							document.getElementById('menu-highlight').style.display = 'none'
							document.getElementById('menu-note').style.display = 'none'
							document.getElementById('menu-clear').style.display = 'block'
							document.getElementById('menu-clear-all').style.display = 'block'
							contextMenu.targetElementForClear = isClickOnHighlight
							showMenu = true
						} else if (
							isSelectionActive &&
							panels.some(panel =>
								panel.contains(selectedRange.commonAncestorContainer)
							)
						) {
							document.getElementById('menu-highlight').style.display = 'flex'
							document.getElementById('menu-note').style.display = 'flex'
							document.getElementById('menu-clear').style.display = 'none'
							document.getElementById('menu-clear-all').style.display = 'block' // Always show clear all
							showMenu = true
						}

						if (showMenu) {
							e.preventDefault()
							contextMenu.style.display = 'block'
							const menuHeight = contextMenu.offsetHeight
							const menuWidth = contextMenu.offsetWidth
							let left = e.pageX
							let top = e.pageY
							if (left + menuWidth > window.innerWidth)
								left = window.innerWidth - menuWidth - 5
							if (top + menuHeight > window.innerHeight)
								top = e.pageY - menuHeight - 5
							else top = e.pageY - menuHeight - 5

							contextMenu.style.left = `${left}px`
							contextMenu.style.top = `${top}px`
						}
					}

					panels.forEach(panel => {
						panel.addEventListener('contextmenu', showContextMenu)
					})

					document.addEventListener('click', e => {
						if (
							contextMenu.style.display === 'block' &&
							!contextMenu.contains(e.target)
						) {
							closeContextMenu()
						}
					})
				}

				function closeContextMenu() {
					contextMenu.style.display = 'none'
					selectedRange = null // Clear range after menu closes
				}

				function unwrapElement(element) {
					const parent = element.parentNode
					if (!parent) return
					while (element.firstChild) {
						parent.insertBefore(element.firstChild, element)
					}
					parent.removeChild(element)
					parent.normalize()
				}

				window.highlightText = () => {
					if (selectedRange && !selectedRange.collapsed) {
						const span = document.createElement('span')
						span.className = 'highlight'
						span.appendChild(selectedRange.extractContents())
						selectedRange.insertNode(span)
					}
					closeContextMenu()
					window.getSelection().removeAllRanges()
				}

				window.addNote = () => {
					const note = prompt('Enter your note:')
					if (note && selectedRange && !selectedRange.collapsed) {
						const span = document.createElement('span')
						span.className = 'comment-highlight'
						const tooltip = document.createElement('span')
						tooltip.className = 'comment-tooltip'
						tooltip.textContent = note
						span.appendChild(selectedRange.extractContents())
						span.appendChild(tooltip)
						selectedRange.insertNode(span)
					}
					closeContextMenu()
					window.getSelection().removeAllRanges()
				}

				window.clearHighlight = () => {
					const elementToClear = contextMenu.targetElementForClear
					if (elementToClear) {
						unwrapElement(elementToClear)
					}
					closeContextMenu()
					window.getSelection().removeAllRanges()
				}

				window.clearAllHighlights = () => {
					document
						.querySelectorAll('.highlight, .comment-highlight')
						.forEach(unwrapElement)
					closeContextMenu()
					window.getSelection().removeAllRanges()
				}

				function updateAttemptedCount(part, startQ, endQ) {
					let answeredCount = 0
					for (let i = startQ; i <= endQ; i++) {
						if (isQuestionAnswered(i)) {
							answeredCount++
						}
					}
					const partHeader = document.querySelector(
						`.footer__questionNo___3WNct[onclick="switchToPart(${part})"]`
					)
					if (partHeader) {
						const countSpan = partHeader.querySelector('.attemptedCount')
						if (countSpan) {
							countSpan.textContent = `${answeredCount} of ${endQ - startQ + 1}`
						}
					}
				}

				// --- GLOBAL FUNCTION EXPOSURE ---
				window.nextQuestion = nextQuestion
				window.previousQuestion = previousQuestion
				window.goToQuestion = goToQuestion
				window.switchToPart = switchToPart
				window.closeResultsModal = closeResultsModal
				window.highlightText = highlightText
				window.addNote = addNote
				window.clearHighlight = clearHighlight
				window.clearAllHighlights = clearAllHighlights

				// Explanation toggle function for Part 2
				window.toggleExplanation = function () {
					const explanationSection =
						document.getElementById('part-2-explanation')
					const button = document.getElementById('show-explanation-btn')

					if (explanationSection.classList.contains('hidden')) {
						explanationSection.classList.remove('hidden')
						button.textContent = 'Hide Explanation'
						button.style.backgroundColor = '#dc3545'
					} else {
						explanationSection.classList.add('hidden')
						button.textContent = 'Show Explanation'
						button.style.backgroundColor = '#4a90e2'
					}
				}

				// Explanation toggle function for Part 3
				window.toggleExplanationPart3 = function () {
					const explanationSection =
						document.getElementById('part-3-explanation')
					const button = document.getElementById('show-explanation-btn-part3')

					if (explanationSection.classList.contains('hidden')) {
						explanationSection.classList.remove('hidden')
						button.textContent = 'Hide Explanation'
						button.style.backgroundColor = '#dc3545'
					} else {
						explanationSection.classList.add('hidden')
						button.textContent = 'Show Explanation'
						button.style.backgroundColor = '#4a90e2'
					}
				}

				// --- START THE APP ---
				initialize()

				// Add event listeners for table radio buttons
				document.addEventListener('DOMContentLoaded', function () {
					const tableRadios = document.querySelectorAll('.table-radio')
					tableRadios.forEach(radio => {
						radio.addEventListener('change', function () {
							// Remove background color from all cells in the same row
							const row = this.closest('tr')
							const cells = row.querySelectorAll('td:not(.statement)')
							cells.forEach(cell => {
								cell.style.backgroundColor = ''
							})

							// Add background color to the selected cell
							if (this.checked) {
								this.closest('td').style.backgroundColor = '#e3f2fd'
							}

							updateAllIndicators()
						})
					})
				})

				// Global function for selecting cells
				window.selectCell = function (cell, questionNum, value) {
					console.log('selectCell called:', questionNum, value)

					// Remove selected class from all cells in the same row
					const row = cell.closest('tr')
					const cellsInRow = row.querySelectorAll('.clickable-cell')
					cellsInRow.forEach(c => {
						c.classList.remove('selected')
						c.removeAttribute('data-selected')
						c.removeAttribute('data-answer')
					})

					// Add selected class to clicked cell
					cell.classList.add('selected')
					cell.setAttribute('data-selected', 'true')
					cell.setAttribute('data-answer', value)

					console.log('Cell selected:', questionNum, value)
					updateAllIndicators()
				}

				// Note: switchToPart function is defined earlier in the code
				// This duplicate function has been removed to prevent conflicts
			})
		</script>
	</body>
</html>
